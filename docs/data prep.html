<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exploring Philadelphia’s Amenity Landscape - Data preparation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Data preparation</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/dancing icon.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mapping Philadelphia's Amenity Clusters</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contact/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Meet the Team</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contact/acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./analysis/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis/methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis/pull_businesses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Obtaining Yelp API Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data/scraping_zillow_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Web-scraping Zillow Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis/data_prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Preparation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis/exploratory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis/text_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zillow Description Cross-Reference</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Takeaways</span></span>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#read-in-amenity-files" id="toc-read-in-amenity-files" class="nav-link active" data-scroll-target="#read-in-amenity-files">Read in amenity files</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#restaurants" id="toc-restaurants" class="nav-link" data-scroll-target="#restaurants">Restaurants</a>
  <ul class="collapse">
  <li><a href="#first-word-in-alias" id="toc-first-word-in-alias" class="nav-link" data-scroll-target="#first-word-in-alias">First word in “alias”</a></li>
  <li><a href="#second-word-in-alias" id="toc-second-word-in-alias" class="nav-link" data-scroll-target="#second-word-in-alias">Second word in “alias”</a></li>
  <li><a href="#third-word-in-alias" id="toc-third-word-in-alias" class="nav-link" data-scroll-target="#third-word-in-alias">Third word in “alias”</a></li>
  <li><a href="#replace-description-1-with-description-2-when-description-1-is-irrelevant" id="toc-replace-description-1-with-description-2-when-description-1-is-irrelevant" class="nav-link" data-scroll-target="#replace-description-1-with-description-2-when-description-1-is-irrelevant">Replace description 1 with description 2 when description 1 is irrelevant</a></li>
  <li><a href="#identify-fast-foodchain-restaurants" id="toc-identify-fast-foodchain-restaurants" class="nav-link" data-scroll-target="#identify-fast-foodchain-restaurants">Identify fast food/chain restaurants</a></li>
  <li><a href="#sort-into-larger-categories" id="toc-sort-into-larger-categories" class="nav-link" data-scroll-target="#sort-into-larger-categories">Sort into larger categories</a></li>
  </ul></li>
  <li><a href="#parks" id="toc-parks" class="nav-link" data-scroll-target="#parks">Parks</a>
  <ul class="collapse">
  <li><a href="#first-word-in-alias-1" id="toc-first-word-in-alias-1" class="nav-link" data-scroll-target="#first-word-in-alias-1">First word in ‘alias’</a></li>
  <li><a href="#filter-for-categories-where-frequency-5" id="toc-filter-for-categories-where-frequency-5" class="nav-link" data-scroll-target="#filter-for-categories-where-frequency-5">Filter for categories where frequency ≥ 5</a></li>
  </ul></li>
  <li><a href="#education" id="toc-education" class="nav-link" data-scroll-target="#education">Education</a>
  <ul class="collapse">
  <li><a href="#first-word-in-alias-2" id="toc-first-word-in-alias-2" class="nav-link" data-scroll-target="#first-word-in-alias-2">First word in alias</a></li>
  <li><a href="#filter-for-frequency-6" id="toc-filter-for-frequency-6" class="nav-link" data-scroll-target="#filter-for-frequency-6">Filter for frequency ≥ 6</a></li>
  </ul></li>
  <li><a href="#grocery" id="toc-grocery" class="nav-link" data-scroll-target="#grocery">Grocery</a></li>
  <li><a href="#nightlife" id="toc-nightlife" class="nav-link" data-scroll-target="#nightlife">Nightlife</a>
  <ul class="collapse">
  <li><a href="#alias" id="toc-alias" class="nav-link" data-scroll-target="#alias">Alias</a></li>
  <li><a href="#replace-desc_1-with-more-relevant-alias-terms" id="toc-replace-desc_1-with-more-relevant-alias-terms" class="nav-link" data-scroll-target="#replace-desc_1-with-more-relevant-alias-terms">Replace desc_1 with more relevant alias terms</a></li>
  <li><a href="#filter-for-categories-where-frequency-8" id="toc-filter-for-categories-where-frequency-8" class="nav-link" data-scroll-target="#filter-for-categories-where-frequency-8">Filter for categories where frequency ≥ 8</a></li>
  </ul></li>
  <li><a href="#entertainment" id="toc-entertainment" class="nav-link" data-scroll-target="#entertainment">Entertainment</a>
  <ul class="collapse">
  <li><a href="#alias-1" id="toc-alias-1" class="nav-link" data-scroll-target="#alias-1">Alias</a></li>
  <li><a href="#replace-desc_1-with-more-relevant-alias-terms-1" id="toc-replace-desc_1-with-more-relevant-alias-terms-1" class="nav-link" data-scroll-target="#replace-desc_1-with-more-relevant-alias-terms-1">Replace desc_1 with more relevant alias terms</a></li>
  <li><a href="#filter-for-frequency" id="toc-filter-for-frequency" class="nav-link" data-scroll-target="#filter-for-frequency">Filter for frequency</a></li>
  </ul></li>
  <li><a href="#shopping" id="toc-shopping" class="nav-link" data-scroll-target="#shopping">Shopping</a>
  <ul class="collapse">
  <li><a href="#alias-2" id="toc-alias-2" class="nav-link" data-scroll-target="#alias-2">Alias</a></li>
  <li><a href="#filter-for-most-common-labels" id="toc-filter-for-most-common-labels" class="nav-link" data-scroll-target="#filter-for-most-common-labels">Filter for most common labels</a></li>
  </ul></li>
  <li><a href="#healthcare" id="toc-healthcare" class="nav-link" data-scroll-target="#healthcare">Healthcare</a>
  <ul class="collapse">
  <li><a href="#alias-3" id="toc-alias-3" class="nav-link" data-scroll-target="#alias-3">Alias</a></li>
  <li><a href="#filter-for-most-common-labels-1" id="toc-filter-for-most-common-labels-1" class="nav-link" data-scroll-target="#filter-for-most-common-labels-1">Filter for most common labels</a></li>
  </ul></li>
  <li><a href="#historic-landmarks" id="toc-historic-landmarks" class="nav-link" data-scroll-target="#historic-landmarks">Historic landmarks</a>
  <ul class="collapse">
  <li><a href="#alias-4" id="toc-alias-4" class="nav-link" data-scroll-target="#alias-4">Alias</a></li>
  <li><a href="#filter-for-most-common-labels-2" id="toc-filter-for-most-common-labels-2" class="nav-link" data-scroll-target="#filter-for-most-common-labels-2">Filter for most common labels</a></li>
  </ul></li>
  <li><a href="#kids-activities" id="toc-kids-activities" class="nav-link" data-scroll-target="#kids-activities">Kids activities</a>
  <ul class="collapse">
  <li><a href="#alias-5" id="toc-alias-5" class="nav-link" data-scroll-target="#alias-5">Alias</a></li>
  </ul></li>
  <li><a href="#art-and-music" id="toc-art-and-music" class="nav-link" data-scroll-target="#art-and-music">Art and music</a>
  <ul class="collapse">
  <li><a href="#alias-6" id="toc-alias-6" class="nav-link" data-scroll-target="#alias-6">Alias</a></li>
  <li><a href="#regroup-into-large-categories" id="toc-regroup-into-large-categories" class="nav-link" data-scroll-target="#regroup-into-large-categories">Regroup into large categories</a></li>
  <li><a href="#filter-for-most-common-labels-3" id="toc-filter-for-most-common-labels-3" class="nav-link" data-scroll-target="#filter-for-most-common-labels-3">Filter for most common labels</a></li>
  </ul></li>
  <li><a href="#beauty" id="toc-beauty" class="nav-link" data-scroll-target="#beauty">Beauty</a></li>
  </ul></li>
  <li><a href="#combine-all-amenities" id="toc-combine-all-amenities" class="nav-link" data-scroll-target="#combine-all-amenities">Combine all amenities</a>
  <ul class="collapse">
  <li><a href="#clip-to-philly-bounds" id="toc-clip-to-philly-bounds" class="nav-link" data-scroll-target="#clip-to-philly-bounds">Clip to Philly bounds</a></li>
  <li><a href="#intersect-with-neighborhoods" id="toc-intersect-with-neighborhoods" class="nav-link" data-scroll-target="#intersect-with-neighborhoods">Intersect with neighborhoods</a></li>
  </ul></li>
  <li><a href="#district-profiles" id="toc-district-profiles" class="nav-link" data-scroll-target="#district-profiles">District profiles</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/LuckyLaharlTim/MUSA_5500_Final.git/blob/main/data prep.ipynb" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data preparation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-tags="[]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Show all columns in dataframes</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="va">None</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_colwidth'</span>, <span class="va">None</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>np.seterr(invalid<span class="op">=</span><span class="st">"ignore"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># phila bounds</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>phl_bound <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/phl_bound.geojson"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>phl_neigh <span class="op">=</span> gpd.read_file(<span class="st">"https://raw.githubusercontent.com/opendataphilly/open-geo-data/master/Neighborhoods_Philadelphia/Neighborhoods_Philadelphia.geojson"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>phl_tract <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/census-tracts.geojson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>phl_bound_proj <span class="op">=</span> phl_bound.to_crs(<span class="dv">2272</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>phl_neigh_proj <span class="op">=</span> phl_neigh.to_crs(<span class="dv">2272</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>phl_tract_proj <span class="op">=</span> phl_tract.to_crs(<span class="dv">2272</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I concatenate neighborhood and tract names to create 384 sub-neighborhoods that still have recognizable neighborhood names.</p>
<div class="cell" data-tags="[]" data-execution_count="6">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Copying the DataFrame</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>tract <span class="op">=</span> phl_tract_proj.copy()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenating 'neighborhood_name' and 'tract_id' into a new column 'nb_name'</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>tract[<span class="st">'nb_name'</span>] <span class="op">=</span> tract[<span class="st">'neighborhood_name'</span>] <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> tract[<span class="st">'tract_id'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>tract[<span class="st">"nb_name"</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>0    Center City East 01
1    Center City East 02
2    Center City West 01
3    Center City West 02
4    Center City West 03
Name: nb_name, dtype: object</code></pre>
</div>
</div>
<p>I calculate areas for each neighborhood so we can later calculate counts of amenities by square mile</p>
<div class="cell" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tract <span class="op">=</span> tract.copy()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate area in square meters</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>tract[<span class="st">'area_m2'</span>] <span class="op">=</span> tract[<span class="st">'geometry'</span>].area</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert area to square miles (1 square mile = 2,589,988.11 square meters)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>tract[<span class="st">'area_mi2'</span>] <span class="op">=</span> tract[<span class="st">'area_m2'</span>] <span class="op">/</span> <span class="dv">27878400</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tract <span class="op">=</span> tract[[<span class="st">"nb_name"</span>, <span class="st">"area_mi2"</span>, <span class="st">"geometry"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I repeat the process for neighborhoods, first selecting and renaming the relevant columns from the projected neighborhood object.</p>
<div class="cell" data-tags="[]" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>neigh <span class="op">=</span> phl_neigh_proj[[<span class="st">"mapname"</span>, <span class="st">"geometry"</span>]].copy()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>neigh[<span class="st">"nb_name"</span>] <span class="op">=</span> neigh[<span class="st">"mapname"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I then calculate the area of each neighborhood</p>
<div class="cell" data-tags="[]" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate area in square meters</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>neigh[<span class="st">'area_m2'</span>] <span class="op">=</span> neigh[<span class="st">'geometry'</span>].area</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert area to square miles (1 square mile = 2,589,988.11 square meters)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>neigh[<span class="st">'area_mi2'</span>] <span class="op">=</span> neigh[<span class="st">'area_m2'</span>] <span class="op">/</span> <span class="dv">27878400</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>neigh <span class="op">=</span> neigh[[<span class="st">"area_mi2"</span>, <span class="st">"nb_name"</span>, <span class="st">"geometry"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="read-in-amenity-files" class="level2">
<h2 class="anchored" data-anchor-id="read-in-amenity-files">Read in amenity files</h2>
<div class="cell" data-tags="[]" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># amenities</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>restaurants <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/restaurants.geojson"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>parks <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/parks.geojson"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>education <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/education.geojson"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>grocery <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/grocery.geojson"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>entertainment <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/entertainment.geojson"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>nightlife <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/nightlife.geojson"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>shopping <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/shopping.geojson"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>healthcare <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/healthcare.geojson"</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>historic <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/historic_landmarks.geojson"</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>kids <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/kids.geojson"</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>arts <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/perf_arts.geojson"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>beauty <span class="op">=</span> gpd.read_file(<span class="st">"data/Yelp API/beauty.geojson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-cleaning" class="level1">
<h1>Data Cleaning</h1>
<section id="restaurants" class="level2">
<h2 class="anchored" data-anchor-id="restaurants">Restaurants</h2>
<div class="cell" data-tags="[]" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and create a copy to avoid SettingWithCopyWarning</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>food_desc <span class="op">=</span> restaurants.copy()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>food_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> food_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>food_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> food_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>food_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> food_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(food_desc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>2697</code></pre>
</div>
</div>
<section id="first-word-in-alias" class="level3">
<h3 class="anchored" data-anchor-id="first-word-in-alias">First word in “alias”</h3>
<div class="cell" data-tags="[]" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_1' and count, then convert to DataFrame</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>food_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">108</td>
<td>pizza</td>
<td>320</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">36</td>
<td>chinese</td>
<td>198</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">118</td>
<td>restaurants</td>
<td>182</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>delis</td>
<td>161</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">124</td>
<td>seafood</td>
<td>101</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>breakfast_brunch</td>
<td>88</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77</td>
<td>hotdogs</td>
<td>84</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">100</td>
<td>newamerican</td>
<td>81</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">122</td>
<td>sandwiches</td>
<td>77</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58</td>
<td>fooddeliveryservices</td>
<td>75</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="second-word-in-alias" class="level3">
<h3 class="anchored" data-anchor-id="second-word-in-alias">Second word in “alias”</h3>
<div class="cell" data-tags="[]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_2' and count, then convert to DataFrame</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>food_desc.groupby(<span class="st">"desc_2"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">111</td>
<td>sandwiches</td>
<td>120</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>breakfast_brunch</td>
<td>86</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">64</td>
<td>hotdogs</td>
<td>79</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>burgers</td>
<td>78</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">112</td>
<td>seafood</td>
<td>73</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>chicken_wings</td>
<td>66</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">131</td>
<td>tradamerican</td>
<td>65</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">72</td>
<td>italian</td>
<td>44</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">98</td>
<td>pizza</td>
<td>42</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>cheesesteaks</td>
<td>41</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="third-word-in-alias" class="level3">
<h3 class="anchored" data-anchor-id="third-word-in-alias">Third word in “alias”</h3>
<div class="cell" data-tags="[]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_3' and count, then convert to DataFrame</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>food_desc.groupby(<span class="st">"desc_3"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_3</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">83</td>
<td>sandwiches</td>
<td>124</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">97</td>
<td>tradamerican</td>
<td>61</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>chicken_wings</td>
<td>41</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50</td>
<td>hotdogs</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>breakfast_brunch</td>
<td>38</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>burgers</td>
<td>33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>coffee</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>delis</td>
<td>26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84</td>
<td>seafood</td>
<td>26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">49</td>
<td>hotdog</td>
<td>23</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="replace-description-1-with-description-2-when-description-1-is-irrelevant" class="level3">
<h3 class="anchored" data-anchor-id="replace-description-1-with-description-2-when-description-1-is-irrelevant">Replace description 1 with description 2 when description 1 is irrelevant</h3>
<p>Words like “restaurant” and “fooddeliveryservices” don’t tell us what kind of food is served. Let’s replace the description in these cases with something more descriptive.</p>
<p>In these cases we can search for restaurants where the first word isn’t descriptive, then replace the desc_1 with desc_2.</p>
<div class="cell" data-tags="[]" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace desc_2</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>condition1 <span class="op">=</span> food_desc[<span class="st">'desc_2'</span>].isin([<span class="st">"food trucks"</span>, <span class="st">"foodtrucks"</span>, <span class="st">"fooddeliveryservices"</span>, <span class="st">"delis"</span>, <span class="st">"bars"</span>, <span class="st">"grocery"</span>, <span class="st">"pubs"</span>, <span class="st">"catering"</span>, <span class="st">"convenience"</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"sportsbars"</span>, <span class="st">"popuprestaurants"</span>, <span class="st">"restaurants"</span>, <span class="st">"foodstands"</span>, <span class="st">"comfortfood"</span>, <span class="st">"food_court"</span>, <span class="st">"lounges"</span>, <span class="st">"breweries"</span>, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"wine_bars"</span>, <span class="st">"bowling"</span>, <span class="st">"meats"</span>, <span class="st">"newamerican"</span>, <span class="st">"tradamerican"</span>, <span class="st">"american"</span>, <span class="st">"buffets"</span>, <span class="st">"foodtrucks"</span>])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>condition2 <span class="op">=</span> food_desc[<span class="st">'desc_3'</span>].notna()</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Update desc_1 where conditions are met</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>food_desc.loc[condition1 <span class="op">&amp;</span> condition2, <span class="st">'desc_2'</span>] <span class="op">=</span> food_desc[<span class="st">'desc_3'</span>]</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># replace desc_1</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>condition1 <span class="op">=</span> food_desc[<span class="st">'desc_1'</span>].isin([<span class="st">"food trucks"</span>, <span class="st">"foodtrucks"</span>, <span class="st">"fooddeliveryservices"</span>, <span class="st">"delis"</span>, <span class="st">"bars"</span>, <span class="st">"grocery"</span>, <span class="st">"pubs"</span>, <span class="st">"catering"</span>, <span class="st">"convenience"</span>, </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"sportsbars"</span>, <span class="st">"popuprestaurants"</span>, <span class="st">"restaurants"</span>, <span class="st">"foodstands"</span>, <span class="st">"comfortfood"</span>, <span class="st">"food_court"</span>, <span class="st">"lounges"</span>, <span class="st">"breweries"</span>, </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"wine_bars"</span>, <span class="st">"bowling"</span>, <span class="st">"meats"</span>, <span class="st">"newamerican"</span>, <span class="st">"tradamerican"</span>, <span class="st">"american"</span>, <span class="st">"buffets"</span>, <span class="st">"foodtrucks"</span>])</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>condition2 <span class="op">=</span> food_desc[<span class="st">'desc_2'</span>].notna()</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Update desc_1 where conditions are met</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>food_desc.loc[condition1 <span class="op">&amp;</span> condition2, <span class="st">'desc_1'</span>] <span class="op">=</span> food_desc[<span class="st">'desc_2'</span>]</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>food_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">111</td>
<td>pizza</td>
<td>339</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>chinese</td>
<td>203</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">124</td>
<td>restaurants</td>
<td>182</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">128</td>
<td>sandwiches</td>
<td>150</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">130</td>
<td>seafood</td>
<td>126</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Unfortunately this didn’t replace “restaurant”. Restaurants with only “restaurants” as the first word in their alias usually don’t have other descriptive words. This shows that “restaurant” is the default. This calls for another approach.</p>
<div class="cell" data-tags="[]" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>food_desc[food_desc[<span class="st">"desc_1"</span>] <span class="op">==</span> <span class="st">"restaurants"</span>].head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">alias</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">desc_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Smitty's Restaurant</td>
<td>0.0</td>
<td>5405 Chester Ave</td>
<td>restaurants</td>
<td>Restaurants</td>
<td>POINT (2676904.285 231029.670)</td>
<td>restaurants</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>Kan Yuen Ping</td>
<td>0.0</td>
<td>5428 Chester Ave</td>
<td>restaurants</td>
<td>Restaurants</td>
<td>POINT (2676791.167 230669.291)</td>
<td>restaurants</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>Silver Place</td>
<td>0.0</td>
<td>1500 S 58th St</td>
<td>restaurants</td>
<td>Restaurants</td>
<td>POINT (2673976.157 231063.740)</td>
<td>restaurants</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>Yuan East Restaurant</td>
<td>0.0</td>
<td>1832 S 58th St</td>
<td>restaurants</td>
<td>Restaurants</td>
<td>POINT (2675345.361 229583.321)</td>
<td>restaurants</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>Wei Hua</td>
<td>0.0</td>
<td>5140 Chester Ave</td>
<td>restaurants</td>
<td>Restaurants</td>
<td>POINT (2677863.415 231724.048)</td>
<td>restaurants</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>By inspecting the names of restaurants lacking descriptions, we can parse out some common categories.</p>
<div class="cell" data-tags="[]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>restaurant_cloud <span class="op">=</span> food_desc[food_desc[<span class="st">"desc_1"</span>] <span class="op">==</span> <span class="st">"restaurants"</span>]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate all text in the column</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">' '</span>.join(restaurant_cloud[<span class="st">'name'</span>].dropna())</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the word cloud</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>wordcloud <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color <span class="op">=</span><span class="st">'white'</span>).generate(text)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the word cloud using matplotlib</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud, interpolation<span class="op">=</span><span class="st">'bilinear'</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data prep_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the mapping</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>keyword_mapping <span class="op">=</span> {</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'yuen'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ping'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'zhong'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'china'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"chinese"</span>: <span class="st">"chinese"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'canton'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'wok'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lee'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'china'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'zhang'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'chung'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dragon'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'meng'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xin'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'hua'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ping'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'hua'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'meng'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'yi'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xi'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lam'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'zhang'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'wei'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'salad'</span>: <span class="st">'salad'</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'pizza'</span>: <span class="st">'pizza'</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grill'</span>: <span class="st">'grill'</span>,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"steak"</span>: <span class="st">"grill"</span>,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sushi'</span>: <span class="st">'japanese'</span>,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'chicken'</span>: <span class="st">'chicken'</span>,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'pizzeria'</span>: <span class="st">'pizza'</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'pizza'</span>: <span class="st">'pizza'</span>,</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'bbg'</span>: <span class="st">'bbq'</span>,</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'hoagie'</span>: <span class="st">'sandwich'</span>,</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">'steaks'</span>: <span class="st">'sandwich'</span>,</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">'coffee'</span>: <span class="st">'cafe'</span>, </span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">'cafe'</span>: <span class="st">'cafe'</span>,</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">'diner'</span>: <span class="st">'american'</span>,</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">'luncheonette'</span>: <span class="st">'american'</span>,</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">'wings'</span>: <span class="st">'wings'</span>,</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">'deli'</span>: <span class="st">'deli'</span>,</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mexican'</span>: <span class="st">'latin'</span>,</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">'guadalupana'</span>: <span class="st">'latin'</span>,</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">'guatamelteco'</span>: <span class="st">'latin'</span>,</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">'fish'</span>: <span class="st">'seafood'</span>,</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">'casa'</span>: <span class="st">'latin'</span>}</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to find the keyword and return the corresponding desc_2 value</span></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> map_keyword_to_desc(name, mapping):</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> keyword, desc <span class="kw">in</span> mapping.items():</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> re.search(re.escape(keyword), name, re.IGNORECASE):</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> desc</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the list of specific values</span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>specific_values <span class="op">=</span> [<span class="st">"food trucks"</span>, <span class="st">"fooddeliveryservices"</span>, <span class="st">"bars"</span>, <span class="st">"grocery"</span>, <span class="st">"restaurants"</span>]</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the combined condition: desc_2 is NA or in the list of specific values</span></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>condition_combined <span class="op">=</span> food_desc[<span class="st">'desc_2'</span>].isna() <span class="op">|</span> food_desc[<span class="st">'desc_1'</span>].isin(specific_values)</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to update desc_2 based on the combined condition</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>food_desc.loc[condition_combined, <span class="st">'desc_1'</span>] <span class="op">=</span> food_desc.loc[condition_combined, <span class="st">'name'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: map_keyword_to_desc(x, keyword_mapping))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="identify-fast-foodchain-restaurants" class="level3">
<h3 class="anchored" data-anchor-id="identify-fast-foodchain-restaurants">Identify fast food/chain restaurants</h3>
<p>Override desc_1 with “fastfood” for major chain restaurants.</p>
<div class="cell" data-tags="[]" data-execution_count="21">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>food_desc.groupby(<span class="st">"name"</span>).size().sort_values(ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>name
Wawa                         28
McDonald's                   25
Popeyes Louisiana Kitchen    19
Wendy's                      17
Philly Pretzel Factory       13
KFC                          13
Subway                       10
Wingstop                      9
Taco Bell                     9
Crown Fried Chicken           8
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="22">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fast_food <span class="op">=</span> [</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"McDonald's"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Wawa"</span>, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Wingstop"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MrBeast Burger"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chick-fil-A"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chipotle Mexican Grill"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Checkers"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Wendy's"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Subway"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Popeyes Louisiana Kitchen"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Taco Bell"</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"KFC"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Burger King"</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="23">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>food_desc.loc[food_desc[<span class="st">"name"</span>].isin(fast_food), <span class="st">"desc_1"</span>] <span class="op">=</span> <span class="st">"fastfood"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Take the descriptions with frequency &lt; 6 and replace the string with the second term in alias</p>
<div class="cell" data-tags="[]" data-execution_count="24">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>desc_counts <span class="op">=</span> food_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for 'desc_1' values where count is less than 6</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>desc_less_than_six <span class="op">=</span> desc_counts[desc_counts[<span class="st">'count'</span>] <span class="op">&lt;</span> <span class="dv">6</span>][<span class="st">'desc_1'</span>]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the filtered results to a list</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>desc_list <span class="op">=</span> desc_less_than_six.tolist()</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># replace desc_1 with desc_2 where desc_1 is in the list of descriptions with frequency &lt; 6</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>food_desc.loc[food_desc[<span class="st">'desc_1'</span>].isin(desc_list), <span class="st">'desc_1'</span>] <span class="op">=</span> food_desc[<span class="st">'desc_2'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="25">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>food_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">83</td>
<td>pizza</td>
<td>327</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>chinese</td>
<td>179</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">47</td>
<td>fastfood</td>
<td>162</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">95</td>
<td>sandwiches</td>
<td>117</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">96</td>
<td>seafood</td>
<td>92</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>breakfast_brunch</td>
<td>81</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>deli</td>
<td>70</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>burgers</td>
<td>55</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>cafe</td>
<td>52</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">65</td>
<td>italian</td>
<td>42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>chicken_wings</td>
<td>38</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">51</td>
<td>grill</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">94</td>
<td>salad</td>
<td>37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">97</td>
<td>soulfood</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>bakeries</td>
<td>36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>coffee</td>
<td>33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76</td>
<td>mexican</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">66</td>
<td>japanese</td>
<td>27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">111</td>
<td>tradamerican</td>
<td>24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>cafes</td>
<td>24</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>cheesesteaks</td>
<td>24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">57</td>
<td>hotdogs</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75</td>
<td>mediterranean</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>caribbean</td>
<td>22</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">104</td>
<td>sushi</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>chicken</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">53</td>
<td>halal</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">42</td>
<td>diners</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>bbq</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">68</td>
<td>juicebars</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">72</td>
<td>latin</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30</td>
<td>cocktailbars</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>desserts</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">61</td>
<td>indpak</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">69</td>
<td>korean</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">116</td>
<td>vietnamese</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">115</td>
<td>venues</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>asianfusion</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">60</td>
<td>icecream</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>american</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">87</td>
<td>pretzels</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>delis</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77</td>
<td>mideastern</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">102</td>
<td>steak</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">109</td>
<td>thai</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50</td>
<td>gastropubs</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">114</td>
<td>vegetarian</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>beerbar</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>african</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>dimsum</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">105</td>
<td>tacos</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>cajun</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">113</td>
<td>vegan</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>ramen</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">120</td>
<td>wings</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>donuts</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">81</td>
<td>noodles</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>chickenshop</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">80</td>
<td>newamerican</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">101</td>
<td>sportsbars</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>cantonese</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">93</td>
<td>russian</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>beer_and_wine</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">74</td>
<td>markets</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">100</td>
<td>spanish</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">119</td>
<td>whiskeybars</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">79</td>
<td>musicvenues</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">82</td>
<td>pancakes</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">89</td>
<td>pubs</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">84</td>
<td>polish</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>acaibowls</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">121</td>
<td>wraps</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">49</td>
<td>french</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>cheese</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">70</td>
<td>kosher</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">63</td>
<td>irish</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">37</td>
<td>danceclubs</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>divebars</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">59</td>
<td>iberian</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">56</td>
<td>hotdog</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">46</td>
<td>falafel</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">103</td>
<td>streetvendors</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>candy</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">106</td>
<td>tapas</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">107</td>
<td>tapasmallplates</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">108</td>
<td>tex-mex</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>cambodian</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>burmese</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">110</td>
<td>themedcafes</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>convenience</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">112</td>
<td>ukrainian</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>buffets</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>bubbletea</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>brewpubs</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>brazilian</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">117</td>
<td>waffles</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">118</td>
<td>waterstores</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>bars</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>airportlounges</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32</td>
<td>comfortfood</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">71</td>
<td>laotian</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>cookingclasses</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">52</td>
<td>haitian</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">73</td>
<td>lounges</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">67</td>
<td>jazzandblues</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">64</td>
<td>irish_pubs</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">62</td>
<td>intlgrocery</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">78</td>
<td>modern_european</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>hotpot</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">55</td>
<td>healthmarkets</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">54</td>
<td>hawaiian</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">85</td>
<td>popuprestaurants</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>southern</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">86</td>
<td>popupshops</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">88</td>
<td>publicmarkets</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">48</td>
<td>fooddeliveryservices</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">91</td>
<td>reiki</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">92</td>
<td>restaurants</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>dominican</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>creperies</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">98</td>
<td>soup</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">36</td>
<td>customcakes</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="26">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>food_cats <span class="op">=</span> food_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>top_food_cats <span class="op">=</span> <span class="bu">list</span>(food_cats[food_cats[<span class="st">"count"</span>] <span class="op">&gt;=</span> <span class="dv">12</span>][<span class="st">"desc_1"</span>])</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>food_desc <span class="op">=</span> food_desc[food_desc[<span class="st">"desc_1"</span>].isin(top_food_cats)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sort-into-larger-categories" class="level3">
<h3 class="anchored" data-anchor-id="sort-into-larger-categories">Sort into larger categories</h3>
<div class="cell" data-tags="[]" data-execution_count="27">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the mapping dictionary</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>desc_mapping <span class="op">=</span> {</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"burgers"</span>: <span class="st">"sandwiches/delis"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hotdogs"</span>: <span class="st">"sandwiches/delis"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"chicken_wings"</span>: <span class="st">"chicken"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tradamerican"</span>: <span class="st">"american"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"newamerican"</span>: <span class="st">"american"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"wings"</span>: <span class="st">"chicken"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hotdog"</span>: <span class="st">"diner/grill"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gastropubs"</span>: <span class="st">"diner/grill"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"diners"</span>: <span class="st">"diner/grill"</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"steak"</span>: <span class="st">"diner/grill"</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"grills"</span>: <span class="st">"diner/grill"</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"grill"</span>: <span class="st">"diner/grill"</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"coffee"</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'cafe'</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cafes"</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'bagels'</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'wraps'</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'soups'</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'soup'</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cupcakes"</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"creperies"</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bakeries"</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"juicebars"</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'donuts'</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'icecream'</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ice cream"</span>: <span class="st">'bakeries/cafes'</span>,</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"desserts"</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"waffles"</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cakeshop"</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'customcakes'</span>: <span class="st">'bakeries/cafes'</span>,</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cheesesteaks"</span>: <span class="st">"sandwiches/delis"</span>,</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sandwich"</span>: <span class="st">"sandwiches/delis"</span>,</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sandwiches"</span>: <span class="st">"sandwiches/delis"</span>,</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"delis"</span>: <span class="st">"sandwiches/delis"</span>,</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"deli"</span>: <span class="st">"sandwiches/delis"</span>,</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"chickenshop"</span>: <span class="st">"chicken"</span>,</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sushi"</span>: <span class="st">"japanese"</span>,</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ramen"</span>: <span class="st">"japanese"</span>,</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">'hotpot'</span>: <span class="st">'chinese'</span>,</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"szechuan"</span>: <span class="st">"chinese"</span>,</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cantonese"</span>: <span class="st">"chinese"</span>,</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dimsum"</span>: <span class="st">"chinese"</span>,</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"shanghainese"</span>: <span class="st">"chinese"</span>,</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pretzels"</span>: <span class="st">"bakeries/cafes"</span>,</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mexican"</span>: <span class="st">"latin"</span>,</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"honduran"</span>: <span class="st">"latin"</span>,</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"nicaraguan"</span>: <span class="st">"latin"</span>,</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"spanish"</span>: <span class="st">"latin"</span>,</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">"guatemalan"</span>: <span class="st">"latin"</span>,</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tacos"</span>: <span class="st">"latin"</span>,</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"brazilian"</span>: <span class="st">"latin"</span>,</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"portuguese"</span>: <span class="st">"latin"</span>,</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dominican"</span>: <span class="st">"caribbean"</span>,</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">"haitian"</span>: <span class="st">"caribbean"</span>,</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">"seafoodmarket,"</span>: <span class="st">"seafood"</span>,</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">"seafoodmarkets,"</span>: <span class="st">"seafood"</span>,</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">"greek"</span>: <span class="st">"mediterranean"</span>,</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mideastern"</span>: <span class="st">"halal"</span></span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace desc_1 values using the mapping dictionary</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>food_desc[<span class="st">'desc_1'</span>] <span class="op">=</span> food_desc[<span class="st">'desc_1'</span>].replace(desc_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="28">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>food_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>pizza</td>
<td>327</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>sandwiches/delis</td>
<td>301</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>bakeries/cafes</td>
<td>199</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>chinese</td>
<td>179</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>fastfood</td>
<td>162</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>seafood</td>
<td>92</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>breakfast_brunch</td>
<td>81</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>chicken</td>
<td>57</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>diner/grill</td>
<td>55</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>japanese</td>
<td>47</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>latin</td>
<td>46</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>italian</td>
<td>42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>soulfood</td>
<td>37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>salad</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>american</td>
<td>36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>mediterranean</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>caribbean</td>
<td>22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>halal</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>bbq</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>cocktailbars</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>venues</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>indpak</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>korean</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>vietnamese</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>asianfusion</td>
<td>12</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="29">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(food_desc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>1858</code></pre>
</div>
</div>
</section>
</section>
<section id="parks" class="level2">
<h2 class="anchored" data-anchor-id="parks">Parks</h2>
<div class="cell" data-tags="[]" data-execution_count="30">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and create a copy to avoid SettingWithCopyWarning</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>parks_desc <span class="op">=</span> parks.copy()</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>parks_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> parks_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>parks_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> parks_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>parks_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> parks_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="first-word-in-alias-1" class="level3">
<h3 class="anchored" data-anchor-id="first-word-in-alias-1">First word in ‘alias’</h3>
<div class="cell" data-tags="[]" data-execution_count="31">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_1' and count, then convert to DataFrame</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>parks_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>parks</td>
<td>150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>landmarks</td>
<td>36</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>playgrounds</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>dog_parks</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>hiking</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>recreation</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>gardens</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>skate_parks</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>tennis</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>football</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>basketballcourts</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>discgolf</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>kids_activities</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>museums</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>nonprofit</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>rafting</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>pets</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>stadiumsarenas</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>publicart</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>swimmingpools</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>amateursportsteams</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>localflavor</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>bars</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>fishing</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>farms</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>farmersmarket</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>climbing</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>bikes</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>baseballfields</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>theater</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="filter-for-categories-where-frequency-5" class="level3">
<h3 class="anchored" data-anchor-id="filter-for-categories-where-frequency-5">Filter for categories where frequency ≥ 5</h3>
<div class="cell" data-tags="[]" data-execution_count="32">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>park_desc_1 <span class="op">=</span> parks_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">9</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>top_park_desc <span class="op">=</span> <span class="bu">list</span>(park_desc_1[<span class="st">"desc_1"</span>])</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove historical landmarks</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>top_park_desc.remove(<span class="st">'landmarks'</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for obs in the list of top descriptions</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>parks_desc <span class="op">=</span> parks_desc[parks_desc[<span class="st">"desc_1"</span>].isin(top_park_desc)]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>parks_desc.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">alias</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">desc_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Cedar Park</td>
<td>4.5</td>
<td>50th St &amp; Baltimore Ave</td>
<td>parks</td>
<td>Parks</td>
<td>POINT (2677006.643 234133.514)</td>
<td>parks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Chester Avenue Dog Park</td>
<td>3.5</td>
<td>801 S 48th St</td>
<td>dog_parks</td>
<td>Dog Parks</td>
<td>POINT (2678024.964 234174.704)</td>
<td>dog_parks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Malcolm X Park</td>
<td>4.0</td>
<td>51ST And Pine St</td>
<td>parks</td>
<td>Parks</td>
<td>POINT (2676187.013 235721.062)</td>
<td>parks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Barkan Park</td>
<td>3.0</td>
<td>4936 Spruce St</td>
<td>parks, playgrounds</td>
<td>Parks, Playgrounds</td>
<td>POINT (2677109.530 236278.545)</td>
<td>parks</td>
<td>playgrounds</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Clark Park Dog Bowl</td>
<td>4.5</td>
<td>43rd &amp; Chester</td>
<td>dog_parks</td>
<td>Dog Parks</td>
<td>POINT (2680815.785 234312.734)</td>
<td>dog_parks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Clark Park</td>
<td>4.5</td>
<td>43RD And Baltimore</td>
<td>parks</td>
<td>Parks</td>
<td>POINT (2680756.007 234729.865)</td>
<td>parks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Greys Ferry Cresent Skatepark</td>
<td>5.0</td>
<td>3600 Grays Ferry Ave</td>
<td>skate_parks</td>
<td>Skate Parks</td>
<td>POINT (2683004.637 231400.562)</td>
<td>skate_parks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Grays Ferry Crescent</td>
<td>4.0</td>
<td></td>
<td>parks</td>
<td>Parks</td>
<td>POINT (2682813.782 232182.835)</td>
<td>parks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Lanier Dog Park</td>
<td>4.0</td>
<td>2911 Tasker St</td>
<td>dog_parks</td>
<td>Dog Parks</td>
<td>POINT (2685221.027 229056.524)</td>
<td>dog_parks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Saunder's Green</td>
<td>3.5</td>
<td>300-50 Saunders Ave</td>
<td>parks</td>
<td>Parks</td>
<td>POINT (2683400.920 238616.685)</td>
<td>parks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="education" class="level2">
<h2 class="anchored" data-anchor-id="education">Education</h2>
<div class="cell" data-tags="[]" data-execution_count="33">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and create a copy to avoid SettingWithCopyWarning</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>edu_desc <span class="op">=</span> education.copy()</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>edu_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> edu_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>edu_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> edu_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>edu_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> edu_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="first-word-in-alias-2" class="level3">
<h3 class="anchored" data-anchor-id="first-word-in-alias-2">First word in alias</h3>
<div class="cell" data-tags="[]" data-execution_count="34">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_1' and count, then convert to DataFrame</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>edu_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>childcare</td>
<td>91</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>elementaryschools</td>
<td>86</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">66</td>
<td>preschools</td>
<td>62</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>collegeuniv</td>
<td>55</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">43</td>
<td>highschools</td>
<td>33</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>driving_schools</td>
<td>31</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>educationservices</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>specialtyschools</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">81</td>
<td>theater</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>artschools</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>cosmetology_schools</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83</td>
<td>tutoring</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>artclasses</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>education</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>dance_schools</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">86</td>
<td>vocation</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>dancestudio</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">68</td>
<td>privatetutors</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">49</td>
<td>montessori</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>cprclasses</td>
<td>7</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="filter-for-frequency-6" class="level3">
<h3 class="anchored" data-anchor-id="filter-for-frequency-6">Filter for frequency ≥ 6</h3>
<div class="cell" data-tags="[]" data-execution_count="35">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>edu_desc_1 <span class="op">=</span> edu_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">18</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>top_edu_desc <span class="op">=</span> <span class="bu">list</span>(edu_desc_1[<span class="st">"desc_1"</span>])</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove historical landmarks</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>top_edu_desc.remove(<span class="st">'theater'</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for obs in the list of top descriptions</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>edu_desc_1 <span class="op">=</span> edu_desc[edu_desc[<span class="st">"desc_1"</span>].isin(top_edu_desc)]</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>edu_desc.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">alias</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">desc_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>BellyWise</td>
<td>5.0</td>
<td>NaN</td>
<td>midwives, specialtyschools</td>
<td>Midwives, Specialty Schools</td>
<td>POINT (2676169.939 231988.984)</td>
<td>midwives</td>
<td>specialtyschools</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Limitless CPR</td>
<td>5.0</td>
<td>NaN</td>
<td>cprclasses</td>
<td>CPR Classes</td>
<td>POINT (2677042.522 231394.414)</td>
<td>cprclasses</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Michele Judge</td>
<td>5.0</td>
<td>4919 Pentridge St</td>
<td>jewelryrepair, artclasses, jewelry</td>
<td>Jewelry Repair, Art Classes, Jewelry</td>
<td>POINT (2677304.635 233898.273)</td>
<td>jewelryrepair</td>
<td>artclasses</td>
<td>jewelry</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Kipp West Philadelphia Prep Charter</td>
<td>1.0</td>
<td>5900 Baltimore Ave</td>
<td>specialed</td>
<td>Special Education</td>
<td>POINT (2671666.162 232636.864)</td>
<td>specialed</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Beulah Baptist Christian Day School</td>
<td>2.0</td>
<td>5001 Spruce St</td>
<td>elementaryschools, preschools</td>
<td>Elementary Schools, Preschools</td>
<td>POINT (2677065.563 236331.076)</td>
<td>elementaryschools</td>
<td>preschools</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>The Academy of Industrial Arts</td>
<td>5.0</td>
<td>6328 Paschall Ave</td>
<td>vocation, electricians</td>
<td>Vocational &amp; Technical School, Electricians</td>
<td>POINT (2674851.743 225884.662)</td>
<td>vocation</td>
<td>electricians</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>TYLII</td>
<td>3.0</td>
<td>5124 Walnut St</td>
<td>preschools, childcare</td>
<td>Preschools, Child Care &amp; Day Care</td>
<td>POINT (2676415.568 237130.841)</td>
<td>preschools</td>
<td>childcare</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>University of the Sciences</td>
<td>3.0</td>
<td>600 S 43rd St</td>
<td>collegeuniv</td>
<td>Colleges &amp; Universities</td>
<td>POINT (2681062.408 233555.127)</td>
<td>collegeuniv</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>All Around This World</td>
<td>5.0</td>
<td>4336 Pine St</td>
<td>educationservices</td>
<td>Educational Services</td>
<td>POINT (2680347.395 235381.376)</td>
<td>educationservices</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Jubilee School</td>
<td>3.0</td>
<td>4211 Chester Ave</td>
<td>highschools</td>
<td>Middle Schools &amp; High Schools</td>
<td>POINT (2681043.809 234475.721)</td>
<td>highschools</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="grocery" class="level2">
<h2 class="anchored" data-anchor-id="grocery">Grocery</h2>
<div class="cell" data-tags="[]" data-execution_count="36">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and create a copy to avoid SettingWithCopyWarning</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>grocery_desc <span class="op">=</span> grocery.copy()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>grocery_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> grocery_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>grocery_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> grocery_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>grocery_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> grocery_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="37">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>grocery_desc.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">alias</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">desc_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Kim A Grocery &amp; Deli</td>
<td>1.0</td>
<td>1840 S 58th St</td>
<td>grocery</td>
<td>Grocery</td>
<td>POINT (2675396.135 229529.164)</td>
<td>grocery</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>S and J Seafood</td>
<td>4.0</td>
<td>713 S 52nd St</td>
<td>seafoodmarkets, grocery</td>
<td>Seafood Markets, Grocery</td>
<td>POINT (2675793.250 234207.384)</td>
<td>seafoodmarkets</td>
<td>grocery</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Mariposa Food Co-op</td>
<td>4.0</td>
<td>4824 Baltimore Ave</td>
<td>grocery, healthmarkets</td>
<td>Grocery, Health Markets</td>
<td>POINT (2677563.153 234052.277)</td>
<td>grocery</td>
<td>healthmarkets</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Jennifer Grocery</td>
<td>2.5</td>
<td>4824 Chester Ave</td>
<td>grocery, convenience</td>
<td>Grocery, Convenience Stores</td>
<td>POINT (2678754.671 232771.760)</td>
<td>grocery</td>
<td>convenience</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Fu-Wah Mini Market</td>
<td>4.5</td>
<td>810 S 47th St</td>
<td>convenience, sandwiches, grocery</td>
<td>Convenience Stores, Sandwiches, Grocery</td>
<td>POINT (2678571.989 234207.924)</td>
<td>convenience</td>
<td>sandwiches</td>
<td>grocery</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="nightlife" class="level2">
<h2 class="anchored" data-anchor-id="nightlife">Nightlife</h2>
<div class="cell" data-tags="[]" data-execution_count="38">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and create a copy to avoid SettingWithCopyWarning</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>night_desc <span class="op">=</span> nightlife.copy()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>night_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> night_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>night_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> night_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>night_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> night_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="39">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>night_desc.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">alias</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">desc_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Pentridge Station Beer Garden</td>
<td>4.5</td>
<td>5116 Pentridge St</td>
<td>beergardens</td>
<td>Beer Gardens</td>
<td>POINT (2676581.781 233167.788)</td>
<td>beergardens</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>720 Bistro</td>
<td>4.0</td>
<td>720 S.52nd st</td>
<td>seafood, breakfast_brunch, cocktailbars</td>
<td>Seafood, Breakfast &amp; Brunch, Cocktail Bars</td>
<td>POINT (2675620.054 234102.746)</td>
<td>seafood</td>
<td>breakfast_brunch</td>
<td>cocktailbars</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Bayou</td>
<td>4.5</td>
<td>5025 Baltimore Ave</td>
<td>lounges</td>
<td>Lounges</td>
<td>POINT (2676525.799 234061.840)</td>
<td>lounges</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Booker's Restaurant and Bar</td>
<td>3.5</td>
<td>5021 Baltimore Ave</td>
<td>bars, breakfast_brunch, tradamerican</td>
<td>Bars, Breakfast &amp; Brunch, American</td>
<td>POINT (2676559.222 234070.085)</td>
<td>bars</td>
<td>breakfast_brunch</td>
<td>tradamerican</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>The Wine Garden</td>
<td>4.5</td>
<td>5019 Baltimore Ave</td>
<td>wine_bars</td>
<td>Wine Bars</td>
<td>POINT (2676563.551 234060.148)</td>
<td>wine_bars</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="alias" class="level3">
<h3 class="anchored" data-anchor-id="alias">Alias</h3>
<div class="cell" data-tags="[]" data-execution_count="40">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_1' and count, then convert to DataFrame</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>night_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>bars</td>
<td>172</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">86</td>
<td>sportsbars</td>
<td>78</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75</td>
<td>pubs</td>
<td>71</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>divebars</td>
<td>53</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">61</td>
<td>lounges</td>
<td>49</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">100</td>
<td>tradamerican</td>
<td>49</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">67</td>
<td>newamerican</td>
<td>47</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>cocktailbars</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">47</td>
<td>hookah_bars</td>
<td>28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">66</td>
<td>musicvenues</td>
<td>28</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="41">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_2' and count, then convert to DataFrame</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>night_desc.groupby(<span class="st">"desc_2"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>bars</td>
<td>93</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">103</td>
<td>tradamerican</td>
<td>61</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">93</td>
<td>sportsbars</td>
<td>48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>cocktailbars</td>
<td>43</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">69</td>
<td>newamerican</td>
<td>39</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">62</td>
<td>lounges</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>seafood</td>
<td>28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">68</td>
<td>musicvenues</td>
<td>25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">80</td>
<td>pubs</td>
<td>24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>beerbar</td>
<td>19</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="42">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_3' and count, then convert to DataFrame</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>night_desc.groupby(<span class="st">"desc_3"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_3</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>cocktailbars</td>
<td>51</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">70</td>
<td>tradamerican</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>bars</td>
<td>24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>breakfast_brunch</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>beerbar</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">72</td>
<td>venues</td>
<td>17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>burgers</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">56</td>
<td>sandwiches</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48</td>
<td>musicvenues</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">62</td>
<td>sportsbars</td>
<td>12</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="replace-desc_1-with-more-relevant-alias-terms" class="level3">
<h3 class="anchored" data-anchor-id="replace-desc_1-with-more-relevant-alias-terms">Replace desc_1 with more relevant alias terms</h3>
<div class="cell" data-tags="[]" data-execution_count="43">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace desc_2</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>condition1 <span class="op">=</span> night_desc[<span class="st">'desc_2'</span>].isin([<span class="st">"newamerican"</span>, <span class="st">"seafood"</span>, <span class="st">"breakfast_brunch"</span>, <span class="st">"tradamerican"</span>, <span class="st">"burgers"</span>, <span class="st">"sandwiches"</span>, <span class="st">"pizza"</span>, <span class="st">"mexican"</span>, <span class="st">"italian"</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"french"</span>, <span class="st">"ramen"</span>, <span class="st">"tapasmallplates"</span>, <span class="st">"french"</span>, <span class="st">"ramen"</span>, <span class="st">"mideastern"</span>, <span class="st">"comfortfood"</span>, <span class="st">"steak"</span>, <span class="st">"mediterranean"</span>, <span class="st">"caribbean"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"bbq"</span>, <span class="st">"peruvian"</span>, <span class="st">"japanese"</span>, <span class="st">"ethiopian"</span>, <span class="st">"tex-mex"</span>, <span class="st">"southern"</span>, <span class="st">"juicebars"</span>, <span class="st">"cajun"</span>, <span class="st">"soulfood"</span>, <span class="st">"portugeuse"</span>, <span class="st">"sushi"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"vegan"</span>, <span class="st">"cafes"</span>, <span class="st">"diners"</span>, <span class="st">"chicken-wings"</span>, <span class="st">"chinese"</span>, <span class="st">"salad"</span>, <span class="st">"cheesesteaks"</span>, <span class="st">"african"</span>, <span class="st">"german"</span>, <span class="st">"desserts"</span>, <span class="st">"indpak"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"thai"</span>, <span class="st">"tacos"</span>, <span class="st">"falafel"</span>, <span class="st">"vietnamese"</span>, <span class="st">"waffles"</span>, <span class="st">"delis"</span>, <span class="st">"coffee"</span>, <span class="st">"korean"</span>, <span class="st">"hotdog"</span>, <span class="st">"moroccan"</span>, <span class="st">"newmexican"</span>, <span class="st">"cuban"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"argentine"</span>, <span class="st">"gluten_free"</span>, <span class="st">"russian"</span>, <span class="st">"bakeries"</span>, <span class="st">"portuguese"</span>, <span class="st">"spanish"</span>, <span class="st">"latin"</span>, <span class="st">"catering"</span>, <span class="st">"gastropubs"</span>, </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"breweries"</span>, <span class="st">"gaybars"</span>, <span class="st">"whiskeybars"</span>, <span class="st">"tikibars"</span>, <span class="st">"tobaccoshops"</span>, <span class="st">"beer_and_wine"</span>, <span class="st">"breweries"</span>, <span class="st">"venues"</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"poolhalls"</span>, <span class="st">"jazzandblues"</span>, <span class="st">"airportlounges"</span>, <span class="st">"cigarbars"</span>, <span class="st">"speakeasies"</span>, <span class="st">"theater"</span>, <span class="st">"nightlife"</span>])</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>condition2 <span class="op">=</span> night_desc[<span class="st">'desc_3'</span>].notna()</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Update desc_1 where conditions are met</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>night_desc.loc[condition1 <span class="op">&amp;</span> condition2, <span class="st">'desc_2'</span>] <span class="op">=</span> night_desc[<span class="st">'desc_3'</span>]</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># replace desc_1</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>condition1 <span class="op">=</span> night_desc[<span class="st">'desc_1'</span>].isin([<span class="st">"newamerican"</span>, <span class="st">"seafood"</span>, <span class="st">"breakfast_brunch"</span>, <span class="st">"tradamerican"</span>, <span class="st">"burgers"</span>, <span class="st">"sandwiches"</span>, <span class="st">"pizza"</span>, <span class="st">"mexican"</span>, <span class="st">"italian"</span>,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"french"</span>, <span class="st">"ramen"</span>, <span class="st">"tapasmallplates"</span>, <span class="st">"french"</span>, <span class="st">"ramen"</span>, <span class="st">"mideastern"</span>, <span class="st">"comfortfood"</span>, <span class="st">"steak"</span>, <span class="st">"mediterranean"</span>, <span class="st">"caribbean"</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"bbq"</span>, <span class="st">"peruvian"</span>, <span class="st">"japanese"</span>, <span class="st">"ethiopian"</span>, <span class="st">"tex-mex"</span>, <span class="st">"southern"</span>, <span class="st">"juicebars"</span>, <span class="st">"cajun"</span>, <span class="st">"soulfood"</span>, <span class="st">"portugeuse"</span>, <span class="st">"sushi"</span>,</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"vegan"</span>, <span class="st">"cafes"</span>, <span class="st">"diners"</span>, <span class="st">"chicken-wings"</span>, <span class="st">"chinese"</span>, <span class="st">"salad"</span>, <span class="st">"cheesesteaks"</span>, <span class="st">"african"</span>, <span class="st">"german"</span>, <span class="st">"desserts"</span>, <span class="st">"indpak"</span>,</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"thai"</span>, <span class="st">"tacos"</span>, <span class="st">"falafel"</span>, <span class="st">"vietnamese"</span>, <span class="st">"waffles"</span>, <span class="st">"delis"</span>, <span class="st">"coffee"</span>, <span class="st">"korean"</span>, <span class="st">"hotdog"</span>, <span class="st">"moroccan"</span>, <span class="st">"newmexican"</span>, <span class="st">"cuban"</span>,</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"argentine"</span>, <span class="st">"gluten_free"</span>, <span class="st">"russian"</span>, <span class="st">"bakeries"</span>, <span class="st">"portuguese"</span>, <span class="st">"spanish"</span>, <span class="st">"latin"</span>, <span class="st">"catering"</span>, <span class="st">"gastropubs"</span>, </span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"breweries"</span>, <span class="st">"gaybars"</span>, <span class="st">"whiskeybars"</span>, <span class="st">"tikibars"</span>, <span class="st">"tobaccoshops"</span>, <span class="st">"beer_and_wine"</span>, <span class="st">"breweries"</span>, <span class="st">"venues"</span>,</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"poolhalls"</span>, <span class="st">"jazzandblues"</span>, <span class="st">"airportlounges"</span>, <span class="st">"cigarbars"</span>, <span class="st">"speakeasies"</span>, <span class="st">"theater"</span>, <span class="st">"nightlife"</span>])</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>condition2 <span class="op">=</span> night_desc[<span class="st">'desc_2'</span>].notna()</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Update desc_1 where conditions are met</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>night_desc.loc[condition1 <span class="op">&amp;</span> condition2, <span class="st">'desc_1'</span>] <span class="op">=</span> night_desc[<span class="st">'desc_2'</span>]</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>night_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>bars</td>
<td>271</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">51</td>
<td>sportsbars</td>
<td>114</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>cocktailbars</td>
<td>105</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>pubs</td>
<td>86</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39</td>
<td>lounges</td>
<td>64</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>divebars</td>
<td>60</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>beerbar</td>
<td>44</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">61</td>
<td>wine_bars</td>
<td>42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>musicvenues</td>
<td>42</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>hookah_bars</td>
<td>36</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>danceclubs</td>
<td>32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>irish_pubs</td>
<td>14</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">37</td>
<td>karaoke</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>beergardens</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>airportlounges</td>
<td>9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="filter-for-categories-where-frequency-8" class="level3">
<h3 class="anchored" data-anchor-id="filter-for-categories-where-frequency-8">Filter for categories where frequency ≥ 8</h3>
<div class="cell" data-tags="[]" data-execution_count="44">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>night_desc_1 <span class="op">=</span> night_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">9</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>top_night_desc <span class="op">=</span> <span class="bu">list</span>(night_desc_1[<span class="st">"desc_1"</span>])</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for obs in the list of top descriptions</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>night_desc <span class="op">=</span> night_desc[night_desc[<span class="st">"desc_1"</span>].isin(top_night_desc)]</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>night_desc.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">alias</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">desc_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>720 Bistro</td>
<td>4.0</td>
<td>720 S.52nd st</td>
<td>seafood, breakfast_brunch, cocktailbars</td>
<td>Seafood, Breakfast &amp; Brunch, Cocktail Bars</td>
<td>POINT (2675620.054 234102.746)</td>
<td>cocktailbars</td>
<td>cocktailbars</td>
<td>cocktailbars</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Bayou</td>
<td>4.5</td>
<td>5025 Baltimore Ave</td>
<td>lounges</td>
<td>Lounges</td>
<td>POINT (2676525.799 234061.840)</td>
<td>lounges</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Booker's Restaurant and Bar</td>
<td>3.5</td>
<td>5021 Baltimore Ave</td>
<td>bars, breakfast_brunch, tradamerican</td>
<td>Bars, Breakfast &amp; Brunch, American</td>
<td>POINT (2676559.222 234070.085)</td>
<td>bars</td>
<td>tradamerican</td>
<td>tradamerican</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>The Wine Garden</td>
<td>4.5</td>
<td>5019 Baltimore Ave</td>
<td>wine_bars</td>
<td>Wine Bars</td>
<td>POINT (2676563.551 234060.148)</td>
<td>wine_bars</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Carbon Copy</td>
<td>4.5</td>
<td>701 S 50th St</td>
<td>breweries, pizza, bars</td>
<td>Breweries, Pizza, Bars</td>
<td>POINT (2676997.957 233927.765)</td>
<td>bars</td>
<td>bars</td>
<td>bars</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>Dock Street Cannery and Tasting Room</td>
<td>4.0</td>
<td>705 S 50th St</td>
<td>beerbar, lounges</td>
<td>Beer Bar, Lounges</td>
<td>POINT (2677046.168 233912.738)</td>
<td>beerbar</td>
<td>lounges</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>Trendsetters Bar &amp; Lounge</td>
<td>3.5</td>
<td>5301 Woodland Ave</td>
<td>burgers, lounges, wraps</td>
<td>Burgers, Lounges, Wraps</td>
<td>POINT (2678439.957 230236.502)</td>
<td>lounges</td>
<td>lounges</td>
<td>wraps</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>The Barn</td>
<td>3.5</td>
<td>4901 Catharine St</td>
<td>poolhalls, sportsbars, divebars</td>
<td>Pool Halls, Sports Bars, Dive Bars</td>
<td>POINT (2677365.738 234212.623)</td>
<td>sportsbars</td>
<td>sportsbars</td>
<td>divebars</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>Eris Temple</td>
<td>4.0</td>
<td>602 S 52nd St</td>
<td>musicvenues</td>
<td>Music Venues</td>
<td>POINT (2675702.055 234852.608)</td>
<td>musicvenues</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>Dahlak</td>
<td>3.5</td>
<td>4708 Baltimore Ave</td>
<td>ethiopian, divebars</td>
<td>Ethiopian, Dive Bars</td>
<td>POINT (2678487.076 234234.642)</td>
<td>divebars</td>
<td>divebars</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="entertainment" class="level2">
<h2 class="anchored" data-anchor-id="entertainment">Entertainment</h2>
<div class="cell" data-tags="[]" data-execution_count="45">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and create a copy to avoid SettingWithCopyWarning</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>entertain_desc <span class="op">=</span> entertainment.copy()</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>entertain_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> entertain_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>entertain_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> entertain_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>entertain_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> entertain_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="46">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>entertain_desc.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">alias</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">desc_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Noam Osband</td>
<td>5.0</td>
<td>NaN</td>
<td>musicians</td>
<td>Musicians</td>
<td>POINT (2676083.283 232370.886)</td>
<td>musicians</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Ceramic Concept</td>
<td>5.0</td>
<td>5015 Baltimore Ave</td>
<td>galleries</td>
<td>Art Galleries</td>
<td>POINT (2676620.711 234054.592)</td>
<td>galleries</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Eris Temple</td>
<td>4.0</td>
<td>602 S 52nd St</td>
<td>musicvenues</td>
<td>Music Venues</td>
<td>POINT (2675702.055 234852.608)</td>
<td>musicvenues</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Baltimore Avenue Dollar Stroll</td>
<td>5.0</td>
<td>4800 Baltimore Ave</td>
<td>unofficialyelpevents, festivals</td>
<td>Unofficial Yelp Events, Festivals</td>
<td>POINT (2677842.004 234135.971)</td>
<td>unofficialyelpevents</td>
<td>festivals</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Curio Theatre Company</td>
<td>4.5</td>
<td>815 S 48th St</td>
<td>theater</td>
<td>Performing Arts</td>
<td>POINT (2678192.432 234160.959)</td>
<td>theater</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="alias-1" class="level3">
<h3 class="anchored" data-anchor-id="alias-1">Alias</h3>
<div class="cell" data-tags="[]" data-execution_count="47">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_1' and count, then convert to DataFrame</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>entertain_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">130</td>
<td>theater</td>
<td>127</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">53</td>
<td>galleries</td>
<td>96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50</td>
<td>festivals</td>
<td>69</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">86</td>
<td>museums</td>
<td>42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>djs</td>
<td>28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">89</td>
<td>musicvenues</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">105</td>
<td>psychics</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">85</td>
<td>movietheaters</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">117</td>
<td>social_clubs</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">47</td>
<td>eventplanning</td>
<td>16</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="48">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>entertain_desc.groupby(<span class="st">"desc_2"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">45</td>
<td>galleries</td>
<td>32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">80</td>
<td>musicvenues</td>
<td>25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">116</td>
<td>theater</td>
<td>24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">119</td>
<td>venues</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35</td>
<td>dancestudio</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>eventplanning</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>danceclubs</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>movietheaters</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>arcades</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>bars</td>
<td>8</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="49">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>entertain_desc.groupby(<span class="st">"desc_3"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_3</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">59</td>
<td>musicvenues</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">92</td>
<td>venues</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>dance_schools</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>dancestudio</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>musicians</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>eventplanning</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">49</td>
<td>kids_activities</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>arcades</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>artclasses</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">89</td>
<td>theater</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="replace-desc_1-with-more-relevant-alias-terms-1" class="level3">
<h3 class="anchored" data-anchor-id="replace-desc_1-with-more-relevant-alias-terms-1">Replace desc_1 with more relevant alias terms</h3>
<div class="cell" data-tags="[]" data-execution_count="50">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace desc_2</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>condition1 <span class="op">=</span> entertain_desc[<span class="st">'desc_2'</span>].isin([<span class="st">"arts"</span>, <span class="st">"musicians"</span>, <span class="st">"kids_activities"</span>, <span class="st">"venues"</span>, <span class="st">"bars"</span>, <span class="st">"nonprofit"</span>, <span class="st">"lounges"</span>])</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>condition2 <span class="op">=</span> entertain_desc[<span class="st">'desc_3'</span>].notna()</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Update desc_1 where conditions are met</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>entertain_desc.loc[condition1 <span class="op">&amp;</span> condition2, <span class="st">'desc_2'</span>] <span class="op">=</span> entertain_desc[<span class="st">'desc_3'</span>]</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># replace desc_1</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>condition1 <span class="op">=</span> entertain_desc[<span class="st">'desc_1'</span>].isin([<span class="st">"arts"</span>, <span class="st">"musicians"</span>, <span class="st">"kids_activities"</span>, <span class="st">"venues"</span>, <span class="st">"bars"</span>, <span class="st">"nonprofit"</span>, <span class="st">"lounges"</span>])</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>condition2 <span class="op">=</span> entertain_desc[<span class="st">'desc_2'</span>].notna()</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Update desc_1 where conditions are met</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>entertain_desc.loc[condition1 <span class="op">&amp;</span> condition2, <span class="st">'desc_1'</span>] <span class="op">=</span> entertain_desc[<span class="st">'desc_2'</span>]</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>entertain_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">131</td>
<td>theater</td>
<td>130</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">55</td>
<td>galleries</td>
<td>98</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">52</td>
<td>festivals</td>
<td>70</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">87</td>
<td>museums</td>
<td>42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">90</td>
<td>musicvenues</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>djs</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">118</td>
<td>social_clubs</td>
<td>24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">106</td>
<td>psychics</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>movietheaters</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">48</td>
<td>eventplanning</td>
<td>17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39</td>
<td>danceclubs</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>countryclubs</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">57</td>
<td>gardens</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>artmuseums</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">104</td>
<td>psychic_astrology</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">40</td>
<td>dancestudio</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95</td>
<td>paintandsip</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">125</td>
<td>stadiumsarenas</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>arts</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>bowling</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>arcades</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">100</td>
<td>photoboothrentals</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">124</td>
<td>sportsteams</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>artclasses</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">37</td>
<td>culturalcenter</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32</td>
<td>comedyclubs</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">105</td>
<td>psychicmediums</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">91</td>
<td>newamerican</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">82</td>
<td>magicians</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">71</td>
<td>jazzandblues</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>catering</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>casinos</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>bingo</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">54</td>
<td>framing</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">122</td>
<td>specialtyschools</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">123</td>
<td>sportsbars</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td></td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>partyequipmentrentals</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>clowns</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>artsandcrafts</td>
<td>3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="filter-for-frequency" class="level3">
<h3 class="anchored" data-anchor-id="filter-for-frequency">Filter for frequency</h3>
<div class="cell" data-tags="[]" data-execution_count="51">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>entertain_desc_1 <span class="op">=</span> entertain_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>entertain_desc_1 <span class="op">=</span> entertain_desc_1[entertain_desc_1[<span class="st">'count'</span>] <span class="op">&gt;=</span> <span class="dv">5</span>]</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>top_entertain_desc <span class="op">=</span> <span class="bu">list</span>(entertain_desc_1[<span class="st">"desc_1"</span>])</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>top_entertain_desc.remove(<span class="st">'psychics'</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for obs in the list of top descriptions</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>entertain_desc <span class="op">=</span> entertain_desc[entertain_desc[<span class="st">"desc_1"</span>].isin(top_entertain_desc)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="52">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>entertain_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">31</td>
<td>theater</td>
<td>130</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>galleries</td>
<td>98</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>festivals</td>
<td>70</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>museums</td>
<td>42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>musicvenues</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>djs</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>social_clubs</td>
<td>24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>movietheaters</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>eventplanning</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>danceclubs</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>countryclubs</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>artmuseums</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>gardens</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>dancestudio</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>paintandsip</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30</td>
<td>stadiumsarenas</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>psychic_astrology</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>photoboothrentals</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>bowling</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>arts</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>arcades</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>culturalcenter</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>artclasses</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>sportsteams</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>newamerican</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>psychicmediums</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>comedyclubs</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>magicians</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>catering</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>casinos</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>jazzandblues</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>bingo</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="53">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the mapping dictionary</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>desc_mapping <span class="op">=</span> {</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"djs"</span>: <span class="st">"nightclubs"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"danceclubs"</span>: <span class="st">"nightclubs"</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artmuseums"</span>: <span class="st">"museums"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sportsteams"</span>: <span class="st">"sports"</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stadiumsarenas"</span>: <span class="st">"sports"</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"paintandsip"</span>: <span class="st">"specialtyclasses"</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dancestudio"</span>: <span class="st">"specialtyclasses"</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bowling"</span>: <span class="st">"games/arcade"</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bingo"</span>: <span class="st">"games/arcade"</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"arcades"</span>: <span class="st">"games/arcade"</span>,</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artclasses"</span>: <span class="st">"specialtyclasses"</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace desc_1 values using the mapping dictionary</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>entertain_desc.loc[:, <span class="st">'desc_1'</span>] <span class="op">=</span> entertain_desc[<span class="st">'desc_1'</span>].replace(desc_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="54">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>entertain_cat <span class="op">=</span> entertain_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>entertain_cat_top <span class="op">=</span> <span class="bu">list</span>(entertain_cat[entertain_cat[<span class="st">"count"</span>] <span class="op">&gt;=</span> <span class="dv">11</span>][<span class="st">"desc_1"</span>])</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for desc_1</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>entertain_desc <span class="op">=</span> entertain_desc[entertain_desc[<span class="st">"desc_1"</span>].isin(entertain_cat_top)]</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>entertain_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>theater</td>
<td>130</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>galleries</td>
<td>98</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>festivals</td>
<td>70</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>museums</td>
<td>52</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>nightclubs</td>
<td>45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>musicvenues</td>
<td>34</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>specialtyclasses</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>social_clubs</td>
<td>24</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>games/arcade</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>movietheaters</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>eventplanning</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>sports</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>countryclubs</td>
<td>11</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="shopping" class="level2">
<h2 class="anchored" data-anchor-id="shopping">Shopping</h2>
<div class="cell" data-tags="[]" data-execution_count="55">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and create a copy to avoid SettingWithCopyWarning</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>shop_desc <span class="op">=</span> shopping.copy()</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>shop_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> shop_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>shop_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> shop_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>shop_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> shop_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="56">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>shop_desc.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">alias</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">desc_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Rite Aid</td>
<td>2.0</td>
<td>5214-30 Baltimore Ave</td>
<td>drugstores, convenience</td>
<td>Drugstores, Convenience Stores</td>
<td>POINT (2675264.630 233732.096)</td>
<td>drugstores</td>
<td>convenience</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Ajah Creative Sweets And Treats &amp; More</td>
<td>5.0</td>
<td>NaN</td>
<td>desserts, cupcakes, giftshops</td>
<td>Desserts, Cupcakes, Gift Shops</td>
<td>POINT (2677939.712 232732.831)</td>
<td>desserts</td>
<td>cupcakes</td>
<td>giftshops</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Ceramic Concept</td>
<td>5.0</td>
<td>5015 Baltimore Ave</td>
<td>galleries</td>
<td>Art Galleries</td>
<td>POINT (2676620.711 234054.592)</td>
<td>galleries</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>VIX Emporium</td>
<td>4.5</td>
<td>5009 Baltimore Ave</td>
<td>artsandcrafts, childcloth, jewelry</td>
<td>Arts &amp; Crafts, Children's Clothing, Jewelry</td>
<td>POINT (2676676.410 234091.659)</td>
<td>artsandcrafts</td>
<td>childcloth</td>
<td>jewelry</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Michele Judge</td>
<td>5.0</td>
<td>4919 Pentridge St</td>
<td>jewelryrepair, artclasses, jewelry</td>
<td>Jewelry Repair, Art Classes, Jewelry</td>
<td>POINT (2677304.635 233898.273)</td>
<td>jewelryrepair</td>
<td>artclasses</td>
<td>jewelry</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="alias-2" class="level3">
<h3 class="anchored" data-anchor-id="alias-2">Alias</h3>
<div class="cell" data-tags="[]" data-execution_count="57">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_1' and count, then convert to DataFrame</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>shop_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>drugstores</td>
<td>234</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">142</td>
<td>womenscloth</td>
<td>114</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">69</td>
<td>jewelry</td>
<td>90</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>discountstore</td>
<td>87</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">49</td>
<td>galleries</td>
<td>84</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">48</td>
<td>furniture</td>
<td>74</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">113</td>
<td>shoes</td>
<td>68</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>deptstores</td>
<td>56</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>menscloth</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>bookstores</td>
<td>41</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="58">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_2' and count, then convert to DataFrame</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>shop_desc.groupby(<span class="st">"desc_2"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>convenience</td>
<td>95</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>accessories</td>
<td>67</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">139</td>
<td>womenscloth</td>
<td>66</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">81</td>
<td>menscloth</td>
<td>51</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48</td>
<td>furniture</td>
<td>38</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">65</td>
<td>jewelry</td>
<td>35</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">100</td>
<td>pharmacy</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>discountstore</td>
<td>32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">49</td>
<td>galleries</td>
<td>29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">61</td>
<td>homedecor</td>
<td>27</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="59">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by desc_3' and count, then convert to DataFrame</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>shop_desc.groupby(<span class="st">"desc_3"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_3</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>convenience</td>
<td>55</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>accessories</td>
<td>30</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">115</td>
<td>womenscloth</td>
<td>28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">54</td>
<td>homedecor</td>
<td>26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">79</td>
<td>pharmacy</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">95</td>
<td>sportswear</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">92</td>
<td>shoes</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">56</td>
<td>jewelry</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>childcloth</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">108</td>
<td>vintage</td>
<td>15</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="filter-for-most-common-labels" class="level3">
<h3 class="anchored" data-anchor-id="filter-for-most-common-labels">Filter for most common labels</h3>
<div class="cell" data-tags="[]" data-execution_count="60">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>shop_desc_1 <span class="op">=</span> shop_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">20</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>top_shop_desc <span class="op">=</span> <span class="bu">list</span>(shop_desc_1[<span class="st">"desc_1"</span>])</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>top_shop_desc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>['drugstores',
 'womenscloth',
 'jewelry',
 'discountstore',
 'galleries',
 'furniture',
 'shoes',
 'deptstores',
 'menscloth',
 'bookstores',
 'accessories',
 'thrift_stores',
 'antiques',
 'grocery',
 'giftshops',
 'homedecor',
 'selfstorage',
 'childcloth',
 'sportswear',
 'vintage']</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="61">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove drugstores and grocery</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>top_shop_desc.remove(<span class="st">'drugstores'</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>top_shop_desc.remove(<span class="st">'grocery'</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for obs in the list of top descriptions</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>shop_desc <span class="op">=</span> shop_desc[shop_desc[<span class="st">"desc_1"</span>].isin(top_shop_desc)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="62">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the mapping dictionary</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>desc_mapping <span class="op">=</span> {</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mattresses"</span>: <span class="st">"furniture"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kitchenandbath"</span>: <span class="st">"furniture"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rugs"</span>: <span class="st">"homedecor"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hats"</span>: <span class="st">"accessories"</span>,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"watch_repair"</span>: <span class="st">"accessories"</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace desc_1 values using the mapping dictionary</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>shop_desc.loc[:, <span class="st">'desc_1'</span>] <span class="op">=</span> shop_desc[<span class="st">'desc_1'</span>].replace(desc_mapping)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>shop_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>womenscloth</td>
<td>114</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>jewelry</td>
<td>90</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>discountstore</td>
<td>87</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>galleries</td>
<td>84</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>furniture</td>
<td>74</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>shoes</td>
<td>68</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>deptstores</td>
<td>56</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>menscloth</td>
<td>50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>bookstores</td>
<td>41</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>accessories</td>
<td>40</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>thrift_stores</td>
<td>36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>antiques</td>
<td>31</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>giftshops</td>
<td>24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>selfstorage</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>homedecor</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>childcloth</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>sportswear</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>vintage</td>
<td>19</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="healthcare" class="level2">
<h2 class="anchored" data-anchor-id="healthcare">Healthcare</h2>
<div class="cell" data-tags="[]" data-execution_count="63">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and create a copy to avoid SettingWithCopyWarning</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>health_desc <span class="op">=</span> healthcare.copy()</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>health_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> health_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>health_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> health_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>health_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> health_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="alias-3" class="level3">
<h3 class="anchored" data-anchor-id="alias-3">Alias</h3>
<div class="cell" data-tags="[]" data-execution_count="64">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_1' and count, then convert to DataFrame</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>health_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>laboratorytesting</td>
<td>33</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">80</td>
<td>urgent_care</td>
<td>26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33</td>
<td>homehealthcare</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>medcenters</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29</td>
<td>generaldentistry</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>hospitals</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">37</td>
<td>internalmed</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>drugstores</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>familydr</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>chiropractors</td>
<td>14</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="filter-for-most-common-labels-1" class="level3">
<h3 class="anchored" data-anchor-id="filter-for-most-common-labels-1">Filter for most common labels</h3>
<div class="cell" data-tags="[]" data-execution_count="65">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>health_desc_1 <span class="op">=</span> health_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">20</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>top_health_desc <span class="op">=</span> <span class="bu">list</span>(shop_desc_1[<span class="st">"desc_1"</span>])</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>top_health_desc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>['drugstores',
 'womenscloth',
 'jewelry',
 'discountstore',
 'galleries',
 'furniture',
 'shoes',
 'deptstores',
 'menscloth',
 'bookstores',
 'accessories',
 'thrift_stores',
 'antiques',
 'grocery',
 'giftshops',
 'homedecor',
 'selfstorage',
 'childcloth',
 'sportswear',
 'vintage']</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="66">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for obs in the list of top descriptions</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>health_desc <span class="op">=</span> health_desc[health_desc[<span class="st">"desc_1"</span>].isin(top_health_desc)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="historic-landmarks" class="level2">
<h2 class="anchored" data-anchor-id="historic-landmarks">Historic landmarks</h2>
<div class="cell" data-tags="[]" data-execution_count="67">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and create a copy to avoid SettingWithCopyWarning</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>historic_desc <span class="op">=</span> historic.copy()</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>historic_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> historic_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>historic_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> historic_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>historic_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> historic_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="alias-4" class="level3">
<h3 class="anchored" data-anchor-id="alias-4">Alias</h3>
<div class="cell" data-tags="[]" data-execution_count="68">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_1' and count, then convert to DataFrame</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>historic_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>landmarks</td>
<td>46</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>museums</td>
<td>25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>artmuseums</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>libraries</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>venues</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>municipality</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>nonprofit</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>postoffices</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>publicart</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>religiousorgs</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="filter-for-most-common-labels-2" class="level3">
<h3 class="anchored" data-anchor-id="filter-for-most-common-labels-2">Filter for most common labels</h3>
<div class="cell" data-tags="[]" data-execution_count="69">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>historic_desc_1 <span class="op">=</span> historic_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">3</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>top_historic_desc <span class="op">=</span> <span class="bu">list</span>(historic_desc_1[<span class="st">"desc_1"</span>])</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>top_historic_desc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>['landmarks', 'museums', 'artmuseums']</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="70">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for obs in the list of top descriptions</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>historic_desc <span class="op">=</span> historic_desc[historic_desc[<span class="st">"desc_1"</span>].isin(top_historic_desc)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="71">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the mapping dictionary</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>desc_mapping <span class="op">=</span> {</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artmuseums"</span>: <span class="st">"museums"</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace desc_1 values using the mapping dictionary</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>historic_desc[<span class="st">'desc_1'</span>] <span class="op">=</span> historic_desc[<span class="st">'desc_1'</span>].replace(desc_mapping)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>historic_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>landmarks</td>
<td>46</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>museums</td>
<td>27</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="kids-activities" class="level2">
<h2 class="anchored" data-anchor-id="kids-activities">Kids activities</h2>
<div class="cell" data-tags="[]" data-execution_count="72">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>kids_desc <span class="op">=</span> kids.copy()</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>kids_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> kids_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>kids_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> kids_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>kids_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> kids_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>kids_desc.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">alias</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">desc_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Makono African Hair Braiding</td>
<td>3.0</td>
<td>5529 Baltimore Ave</td>
<td>hairstylists, cosmetics</td>
<td>Hair Stylists, Cosmetics &amp; Beauty Supply</td>
<td>POINT (2673677.520 233714.490)</td>
<td>hairstylists</td>
<td>cosmetics</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Carbon Copy</td>
<td>4.5</td>
<td>701 S 50th St</td>
<td>breweries, pizza, bars</td>
<td>Breweries, Pizza, Bars</td>
<td>POINT (2676997.957 233927.765)</td>
<td>breweries</td>
<td>pizza</td>
<td>bars</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Firehouse Bicycles</td>
<td>4.5</td>
<td>701 S 50th St</td>
<td>bikes, bike_repair_maintenance</td>
<td>Bikes, Bike Repair/Maintenance</td>
<td>POINT (2677005.367 233951.502)</td>
<td>bikes</td>
<td>bike_repair_maintenance</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Common Beat Music</td>
<td>4.0</td>
<td>4916 Baltimore Ave</td>
<td>vinyl_records, electronicsrepair, musicinstrumentservices</td>
<td>Vinyl Records, Electronics Repair, Musical Instrument Services</td>
<td>POINT (2677188.738 233998.088)</td>
<td>vinyl_records</td>
<td>electronicsrepair</td>
<td>musicinstrumentservices</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Cedar Park</td>
<td>4.5</td>
<td>50th St &amp; Baltimore Ave</td>
<td>parks</td>
<td>Parks</td>
<td>POINT (2677006.643 234133.514)</td>
<td>parks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="alias-5" class="level3">
<h3 class="anchored" data-anchor-id="alias-5">Alias</h3>
<div class="cell" data-tags="[]" data-execution_count="73">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_1' and count, then convert to DataFrame</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>kids_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">45</td>
<td>childcare</td>
<td>92</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">232</td>
<td>parks</td>
<td>53</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">131</td>
<td>generaldentistry</td>
<td>39</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">87</td>
<td>drugstores</td>
<td>36</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">141</td>
<td>gyms</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">255</td>
<td>preschools</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">311</td>
<td>theater</td>
<td>26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">95</td>
<td>elementaryschools</td>
<td>26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">189</td>
<td>libraries</td>
<td>26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">107</td>
<td>festivals</td>
<td>25</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="74">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>kids_desc <span class="op">=</span> kids_desc[kids_desc[<span class="st">"desc_1"</span>].isin([<span class="st">"childcare"</span>, <span class="st">"parks"</span>, <span class="st">"preschools"</span>, <span class="st">"theater"</span>, <span class="st">"libraries"</span>, <span class="st">"festivals"</span>, <span class="st">"museums"</span>, </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"martialarts"</span>, <span class="st">"churches"</span>, <span class="st">"playgrounds"</span>, <span class="st">"musicalinstrumentsandteachers"</span>, <span class="st">"landmarks"</span>, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"kids_activities"</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="75">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>kids_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>childcare</td>
<td>92</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>parks</td>
<td>53</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>preschools</td>
<td>29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>libraries</td>
<td>26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>theater</td>
<td>26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>festivals</td>
<td>25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>museums</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>churches</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>martialarts</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>playgrounds</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>musicalinstrumentsandteachers</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>landmarks</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>kids_activities</td>
<td>13</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="art-and-music" class="level2">
<h2 class="anchored" data-anchor-id="art-and-music">Art and music</h2>
<div class="cell" data-tags="[]" data-execution_count="76">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>arts_desc <span class="op">=</span> arts.copy()</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>arts_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> arts_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>arts_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> arts_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>arts_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> arts_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>arts_desc.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">alias</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">desc_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Curio Theatre Company</td>
<td>4.5</td>
<td>815 S 48th St</td>
<td>theater</td>
<td>Performing Arts</td>
<td>POINT (2678192.432 234160.959)</td>
<td>theater</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Studio 34</td>
<td>4.5</td>
<td>4522 Baltimore Ave</td>
<td>yoga, pilates, theater</td>
<td>Yoga, Pilates, Performing Arts</td>
<td>POINT (2679553.196 234477.061)</td>
<td>yoga</td>
<td>pilates</td>
<td>theater</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Painted Bride Art Center</td>
<td>3.5</td>
<td>5212 Market St</td>
<td>theater, venues</td>
<td>Performing Arts, Venues &amp; Event Spaces</td>
<td>POINT (2676029.704 238278.040)</td>
<td>theater</td>
<td>venues</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>The Rotunda</td>
<td>4.5</td>
<td>4014 Walnut St</td>
<td>musicvenues, theater</td>
<td>Music Venues, Performing Arts</td>
<td>POINT (2682266.656 236480.866)</td>
<td>musicvenues</td>
<td>theater</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Penn Live Arts</td>
<td>4.0</td>
<td>3680 Walnut St</td>
<td>theater, jazzandblues, musicvenues</td>
<td>Performing Arts, Jazz &amp; Blues, Music Venues</td>
<td>POINT (2684326.329 236037.832)</td>
<td>theater</td>
<td>jazzandblues</td>
<td>musicvenues</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="alias-6" class="level3">
<h3 class="anchored" data-anchor-id="alias-6">Alias</h3>
<div class="cell" data-tags="[]" data-execution_count="77">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_1' and count, then convert to DataFrame</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>arts_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>theater</td>
<td>163</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>dancestudio</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>musicalinstrumentsandteachers</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>galleries</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>musicvenues</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>musicians</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>festivals</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>dance_schools</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>artschools</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>artmuseums</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="regroup-into-large-categories" class="level3">
<h3 class="anchored" data-anchor-id="regroup-into-large-categories">Regroup into large categories</h3>
<div class="cell" data-tags="[]" data-execution_count="78">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the mapping dictionary</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>desc_mapping <span class="op">=</span> {</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"specialtyschools"</span>: <span class="st">"classes"</span>,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dance_schools"</span>: <span class="st">"classes"</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artschools"</span>: <span class="st">"classes"</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"musicalinstrumentsandteachers"</span>: <span class="st">"classes"</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dancestudio"</span>: <span class="st">"dancestudios"</span>,</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"galleries"</span>: <span class="st">"gallery/museum"</span>,</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"museums"</span>: <span class="st">"gallery/museum"</span>,</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artmuseums"</span>: <span class="st">"gallery/museum"</span>,</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"festivals"</span>: <span class="st">"events/shows"</span>,</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"jazzandblues"</span>: <span class="st">"events/shows"</span>,</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"djs"</span>: <span class="st">"events/shows"</span>,</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"musicvenues"</span>: <span class="st">"events/shows"</span>,</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"comedyclubs"</span>: <span class="st">"events/shows"</span>,</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"magicians"</span>: <span class="st">"events/shows"</span>,</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"musicians"</span>: <span class="st">"events/shows"</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace desc_1 values using the mapping dictionary</span></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>arts_desc[<span class="st">'desc_1'</span>] <span class="op">=</span>arts_desc[<span class="st">'desc_1'</span>].replace(desc_mapping)</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>arts_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>theater</td>
<td>163</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>events/shows</td>
<td>24</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>classes</td>
<td>22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>gallery/museum</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>dancestudios</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>culturalcenter</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>aerialfitness</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>opera</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>venues</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>summer_camps</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>social_clubs</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>preschools</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>hair</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>nonprofit</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>language_schools</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>arts</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>educationservices</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>dinnertheater</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>yoga</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="filter-for-most-common-labels-3" class="level3">
<h3 class="anchored" data-anchor-id="filter-for-most-common-labels-3">Filter for most common labels</h3>
<div class="cell" data-tags="[]" data-execution_count="79">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>arts_desc_1 <span class="op">=</span> arts_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">20</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>top_arts_desc <span class="op">=</span> <span class="bu">list</span>(arts_desc_1[<span class="st">"desc_1"</span>])</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove historical landmarks</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>top_arts_desc.remove(<span class="st">'summer_camps'</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>top_arts_desc.remove(<span class="st">'preschools'</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>top_arts_desc.remove(<span class="st">'language_schools'</span>)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>top_arts_desc.remove(<span class="st">'educationservices'</span>)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>top_arts_desc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>['theater',
 'events/shows',
 'classes',
 'gallery/museum',
 'dancestudios',
 'culturalcenter',
 'aerialfitness',
 'opera',
 'venues',
 'social_clubs',
 'hair',
 'nonprofit',
 'arts',
 'dinnertheater',
 'yoga']</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="80">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>arts_desc <span class="op">=</span> arts_desc[arts_desc[<span class="st">"desc_1"</span>].isin(top_arts_desc)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="beauty" class="level2">
<h2 class="anchored" data-anchor-id="beauty">Beauty</h2>
<div class="cell" data-tags="[]" data-execution_count="81">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>beauty_desc <span class="op">=</span> beauty.copy()</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'desc_1'</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>beauty_desc[<span class="st">"desc_1"</span>] <span class="op">=</span> beauty_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">0</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>beauty_desc[<span class="st">"desc_2"</span>] <span class="op">=</span> beauty_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">1</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>beauty_desc[<span class="st">"desc_3"</span>] <span class="op">=</span> beauty_desc[<span class="st">'alias'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).<span class="bu">str</span>[<span class="dv">2</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.lower()</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>beauty_desc.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rating</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">alias</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">desc_2</th>
<th data-quarto-table-cell-role="th">desc_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2156</td>
<td>Lips and Drips by Erica Marie</td>
<td>5.0</td>
<td>2342 S Broad St</td>
<td>medicalspa, ivhydration</td>
<td>Medical Spas, IV Hydration</td>
<td>POINT (2691839.535 224599.252)</td>
<td>medicalspa</td>
<td>ivhydration</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2157</td>
<td>The Lash Lounge Wyndmoor - 909 Willow</td>
<td>4.0</td>
<td>909 E Willow Grove Ave</td>
<td>eyelashservice, eyebrowservices, threadingservices</td>
<td>Eyelash Service, Eyebrow Services, Threading Services</td>
<td>POINT (2685044.968 283383.097)</td>
<td>eyelashservice</td>
<td>eyebrowservices</td>
<td>threadingservices</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2158</td>
<td>Hair Expo</td>
<td>3.5</td>
<td>7721 Crittenden St</td>
<td>hairstylists</td>
<td>Hair Stylists</td>
<td>POINT (2683447.588 279731.355)</td>
<td>hairstylists</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2159</td>
<td>The Cut Bar</td>
<td>4.0</td>
<td>532 S 4th St</td>
<td>barbers</td>
<td>Barbers</td>
<td>POINT (2697625.976 232400.348)</td>
<td>barbers</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2160</td>
<td>House of Hair Lounge</td>
<td>3.0</td>
<td>259 S 60th St</td>
<td>hairstylists</td>
<td>Hair Stylists</td>
<td>POINT (2671622.181 237231.748)</td>
<td>hairstylists</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="82">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'desc_1' and count, then convert to DataFrame</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>beauty_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">desc_1</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">85</td>
<td>hair</td>
<td>378</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">146</td>
<td>othersalons</td>
<td>342</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>barbers</td>
<td>149</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">89</td>
<td>hairstylists</td>
<td>87</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">43</td>
<td>cosmetics</td>
<td>82</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">119</td>
<td>massage</td>
<td>74</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">70</td>
<td>florists</td>
<td>53</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">117</td>
<td>makeupartists</td>
<td>49</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>hair_extensions</td>
<td>35</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">188</td>
<td>tattoo</td>
<td>33</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="83">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>remove_cat <span class="op">=</span> [<span class="st">"florists"</span>, <span class="st">"jewelry"</span>, <span class="st">"drugstores"</span>, <span class="st">"generaldentistry"</span>, <span class="st">"discountstore"</span>, <span class="st">"womenscloth"</span>, </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"deptstores"</span>, <span class="st">"furniture"</span>, <span class="st">""</span>, <span class="st">"bookstores"</span>, <span class="st">"galleries"</span>, <span class="st">"giftshops"</span>, <span class="st">"artsandcrafts"</span>, </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"gardening"</span>, <span class="st">"fabricstores"</span>, <span class="st">"antiques"</span>, <span class="st">"menscloth"</span>, <span class="st">"orthodontists"</span>, <span class="st">"vintage"</span>, </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"thriftstores"</span>, <span class="st">"stationary"</span>, <span class="st">"bikes"</span>, <span class="st">"beautysvc"</span>, <span class="st">"accessories"</span>, <span class="st">"optometrists"</span>, </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"framing"</span>, <span class="st">"interiordesign"</span>, <span class="st">"tobaccoshops"</span>, <span class="st">"homedecor"</span>, <span class="st">"stationary"</span>, <span class="st">"thriftstores"</span>]</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping, counting, and filtering beauty_desc</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>beauty_desc_1 <span class="op">=</span> beauty_desc.groupby(<span class="st">"desc_1"</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>).sort_values(<span class="st">"count"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>top_beauty_desc <span class="op">=</span> beauty_desc_1[beauty_desc_1[<span class="st">'count'</span>] <span class="op">&gt;</span> <span class="dv">6</span>]</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering top_beauty_desc to remove unwanted categories</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>top_beauty_desc <span class="op">=</span> top_beauty_desc[<span class="op">~</span>top_beauty_desc[<span class="st">"desc_1"</span>].isin(remove_cat)][<span class="st">"desc_1"</span>]</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>beauty_desc <span class="op">=</span> beauty_desc[beauty_desc[<span class="st">"desc_1"</span>].isin(top_beauty_desc)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="combine-all-amenities" class="level1">
<h1>Combine all amenities</h1>
<div class="cell" data-tags="[]" data-execution_count="84">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create explicit copies of the DataFrame slices</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>food_desc <span class="op">=</span> food_desc.copy()</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>parks_desc <span class="op">=</span> parks_desc.copy()</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>edu_desc <span class="op">=</span> edu_desc.copy()</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>grocery_desc <span class="op">=</span> grocery_desc.copy()</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>entertain_desc <span class="op">=</span> entertain_desc.copy()</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>night_desc <span class="op">=</span> night_desc.copy()</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>shop_desc <span class="op">=</span> shop_desc.copy()</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>health_desc <span class="op">=</span> health_desc.copy()</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>historic_desc <span class="op">=</span> historic_desc.copy()</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>arts_desc <span class="op">=</span> arts_desc.copy()</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>beauty_desc <span class="op">=</span> beauty_desc.copy()</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>kids_desc <span class="op">=</span> kids_desc.copy()</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Now perform the operations</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>food_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'restaurant'</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>parks_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'parks'</span></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>edu_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'education'</span></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>grocery_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'grocery'</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>entertain_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'entertainment'</span></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>night_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'nightlife'</span></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>shop_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'shopping'</span></span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>health_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'healthcare'</span></span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>historic_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'historic'</span></span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>arts_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'arts'</span></span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>beauty_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'beauty'</span></span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>kids_desc.loc[:, <span class="st">'type'</span>] <span class="op">=</span> <span class="st">'kids'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="85">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine gdfs</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>amenities <span class="op">=</span> gpd.GeoDataFrame(pd.concat([food_desc, parks_desc, edu_desc, grocery_desc, entertain_desc, night_desc, shop_desc,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                                       health_desc, historic_desc, arts_desc, beauty_desc, kids_desc], ignore_index<span class="op">=</span><span class="va">True</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="clip-to-philly-bounds" class="level2">
<h2 class="anchored" data-anchor-id="clip-to-philly-bounds">Clip to Philly bounds</h2>
<div class="cell" data-tags="[]" data-execution_count="135">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>phl_bound_squeezed <span class="op">=</span> phl_bound_proj.squeeze().geometry</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>amenities_phl <span class="op">=</span> amenities.within(phl_bound_squeezed)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>amenities_phl_gdf <span class="op">=</span> amenities[amenities_phl]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="91">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count by type</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>amenities_grouped <span class="op">=</span> amenities_phl_gdf.groupby(<span class="st">'type'</span>).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="92">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>amenities_grouped.to_csv(<span class="st">'amenities_grouped.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>amenities_phl_gdf.to_file(<span class="st">'amenities_phl_gdf.geojson'</span>, driver<span class="op">=</span><span class="st">'GeoJSON'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="113">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>amenities_tract.to_file(<span class="st">'amenities_tract.geojson'</span>, driver<span class="op">=</span><span class="st">'GeoJSON'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="intersect-with-neighborhoods" class="level2">
<h2 class="anchored" data-anchor-id="intersect-with-neighborhoods">Intersect with neighborhoods</h2>
<div class="cell" data-tags="[]" data-execution_count="95">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>amenities_neighborhood <span class="op">=</span> gpd.sjoin(amenities_phl_gdf, neigh, how <span class="op">=</span> <span class="st">"left"</span>, predicate <span class="op">=</span> <span class="st">"intersects"</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>amenities_tract <span class="op">=</span> gpd.sjoin(amenities_phl_gdf, tract, how <span class="op">=</span> <span class="st">"left"</span>, predicate <span class="op">=</span> <span class="st">"intersects"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="116">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>amenities_neigh_group <span class="op">=</span> amenities_neighborhood.groupby([<span class="st">"nb_name"</span>, <span class="st">"type"</span>]).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>amenities_tract_group <span class="op">=</span> amenities_tract.groupby([<span class="st">"nb_name"</span>, <span class="st">"type"</span>]).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="117">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>amenities_tract_group.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nb_name</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Airport-Navy Yard 01</td>
<td>entertainment</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Airport-Navy Yard 01</td>
<td>kids</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Airport-Navy Yard 01</td>
<td>nightlife</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Airport-Navy Yard 01</td>
<td>restaurant</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Airport-Navy Yard 02</td>
<td>beauty</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="118">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>amenities_neigh_total <span class="op">=</span> amenities_neigh_group.groupby(<span class="st">"nb_name"</span>)[<span class="st">'count'</span>].<span class="bu">sum</span>().reset_index(name<span class="op">=</span><span class="st">'total_amenities'</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>amenities_tract_total <span class="op">=</span> amenities_tract_group.groupby(<span class="st">"nb_name"</span>)[<span class="st">'count'</span>].<span class="bu">sum</span>().reset_index(name<span class="op">=</span><span class="st">'total_amenities'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="119">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>amenities_tract_total.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nb_name</th>
<th data-quarto-table-cell-role="th">total_amenities</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Airport-Navy Yard 01</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Airport-Navy Yard 02</td>
<td>54</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Airport-Navy Yard 03</td>
<td>43</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Airport-Navy Yard 04</td>
<td>42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Airport-Navy Yard 05</td>
<td>48</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="120">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>amenities_neigh_group <span class="op">=</span> amenities_neigh_group.merge(amenities_neigh_total, on<span class="op">=</span><span class="st">"nb_name"</span>, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>amenities_tract_group <span class="op">=</span> amenities_tract_group.merge(amenities_tract_total, on<span class="op">=</span><span class="st">"nb_name"</span>, how<span class="op">=</span><span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="121">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>amenities_tract_group.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nb_name</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">total_amenities</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Airport-Navy Yard 01</td>
<td>entertainment</td>
<td>2</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Airport-Navy Yard 01</td>
<td>kids</td>
<td>2</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Airport-Navy Yard 01</td>
<td>nightlife</td>
<td>1</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Airport-Navy Yard 01</td>
<td>restaurant</td>
<td>3</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Airport-Navy Yard 02</td>
<td>beauty</td>
<td>1</td>
<td>54</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="123">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>amenities_neigh_group[<span class="st">"pct_share"</span>] <span class="op">=</span> (<span class="dv">100</span><span class="op">*</span>amenities_neigh_group[<span class="st">"count"</span>]<span class="op">/</span>amenities_neigh_group[<span class="st">"total_amenities"</span>]).<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>amenities_tract_group[<span class="st">"pct_share"</span>] <span class="op">=</span> (<span class="dv">100</span><span class="op">*</span>amenities_tract_group[<span class="st">"count"</span>]<span class="op">/</span>amenities_tract_group[<span class="st">"total_amenities"</span>]).<span class="bu">round</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="124">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>amenities_tract_group.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nb_name</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">total_amenities</th>
<th data-quarto-table-cell-role="th">pct_share</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Airport-Navy Yard 01</td>
<td>entertainment</td>
<td>2</td>
<td>8</td>
<td>25.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Airport-Navy Yard 01</td>
<td>kids</td>
<td>2</td>
<td>8</td>
<td>25.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Airport-Navy Yard 01</td>
<td>nightlife</td>
<td>1</td>
<td>8</td>
<td>12.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Airport-Navy Yard 01</td>
<td>restaurant</td>
<td>3</td>
<td>8</td>
<td>37.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Airport-Navy Yard 02</td>
<td>beauty</td>
<td>1</td>
<td>54</td>
<td>1.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="126">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>amenities_neigh_group_gdf <span class="op">=</span> amenities_neigh_group.merge(neigh, on <span class="op">=</span> <span class="st">"nb_name"</span>, how <span class="op">=</span> <span class="st">"left"</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>amenities_tract_group_gdf <span class="op">=</span> amenities_tract_group.merge(tract, on <span class="op">=</span> <span class="st">"nb_name"</span>, how <span class="op">=</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="127">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>amenities_neigh <span class="op">=</span> gpd.GeoDataFrame(amenities_neigh_group_gdf, geometry<span class="op">=</span><span class="st">'geometry'</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>amenities_tract <span class="op">=</span> gpd.GeoDataFrame(amenities_tract_group_gdf, geometry<span class="op">=</span><span class="st">'geometry'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="128">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>amenities_nb <span class="op">=</span> amenities_neigh[[<span class="st">"nb_name"</span>, <span class="st">"type"</span>, <span class="st">"count"</span>, <span class="st">"total_amenities"</span>, <span class="st">"pct_share"</span>, <span class="st">"geometry"</span>, <span class="st">"area_mi2"</span>]]</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>amenities_tr <span class="op">=</span> amenities_tract[[<span class="st">"nb_name"</span>, <span class="st">"type"</span>, <span class="st">"count"</span>, <span class="st">"total_amenities"</span>, <span class="st">"pct_share"</span>, <span class="st">"geometry"</span>, <span class="st">"area_mi2"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="129">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>amenities_nb <span class="op">=</span> amenities_nb.copy()</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>amenities_nb.loc[:, <span class="st">'count_per_mi2'</span>] <span class="op">=</span> amenities_nb[<span class="st">'count'</span>] <span class="op">/</span> amenities_nb[<span class="st">'area_mi2'</span>]</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>amenities_tr <span class="op">=</span> amenities_tr.copy()</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>amenities_tr.loc[:, <span class="st">'count_per_mi2'</span>] <span class="op">=</span> amenities_tr[<span class="st">'count'</span>] <span class="op">/</span> amenities_tr[<span class="st">'area_mi2'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="131">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>amenities_nb.to_file(<span class="st">'amenities_neigh.geojson'</span>, driver<span class="op">=</span><span class="st">'GeoJSON'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>amenities_tr.to_file(<span class="st">'amenities_tract.geojson'</span>, driver<span class="op">=</span><span class="st">'GeoJSON'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="112">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># spreading the data</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>amenities_nb_wide <span class="op">=</span> amenities_nb.pivot_table(index<span class="op">=</span><span class="st">'nb_name'</span>, columns<span class="op">=</span><span class="st">'type'</span>, values<span class="op">=</span><span class="st">'pct_share'</span>, aggfunc<span class="op">=</span>np.mean).fillna(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="district-profiles" class="level1">
<h1>District profiles</h1>
<div class="cell" data-tags="[]" data-execution_count="1173">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>clusters <span class="op">=</span> gpd.read_file(<span class="st">"data/clusters.geojson"</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>districts <span class="op">=</span> gpd.read_file(<span class="st">"data/Planning_Districts.geojson"</span>)[[<span class="st">"DIST_NAME"</span>, <span class="st">"geometry"</span>]]</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>districts_proj <span class="op">=</span> districts.to_crs(<span class="dv">2272</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>cluster_ctr <span class="op">=</span> clusters.copy()</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>cluster_ctr.geometry <span class="op">=</span> cluster_ctr.geometry.centroid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="1174">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>tract_dist <span class="op">=</span> cluster_ctr.sjoin(districts_proj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="1175">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>district_profile <span class="op">=</span> tract_dist.groupby(<span class="st">"DIST_NAME"</span>)[[<span class="st">'arts'</span>, <span class="st">'beauty'</span>, <span class="st">'education'</span>, <span class="st">'entertainment'</span>, <span class="st">'grocery'</span>, </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">'healthcare'</span>, <span class="st">'historic'</span>, <span class="st">'kids'</span>, <span class="st">'nightlife'</span>, <span class="st">'parks'</span>, </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">'restaurant'</span>, <span class="st">'shopping'</span>]].mean()</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>district_profile.to_csv(<span class="st">'district_profile.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>district_profile</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1175">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">arts</th>
<th data-quarto-table-cell-role="th">beauty</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">entertainment</th>
<th data-quarto-table-cell-role="th">grocery</th>
<th data-quarto-table-cell-role="th">healthcare</th>
<th data-quarto-table-cell-role="th">historic</th>
<th data-quarto-table-cell-role="th">kids</th>
<th data-quarto-table-cell-role="th">nightlife</th>
<th data-quarto-table-cell-role="th">parks</th>
<th data-quarto-table-cell-role="th">restaurant</th>
<th data-quarto-table-cell-role="th">shopping</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">DIST_NAME</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Central</td>
<td>5.331579</td>
<td>11.152632</td>
<td>9.994737</td>
<td>12.452632</td>
<td>7.284211</td>
<td>0.094737</td>
<td>1.942105</td>
<td>5.894737</td>
<td>12.963158</td>
<td>3.842105</td>
<td>14.989474</td>
<td>14.063158</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Central Northeast</td>
<td>0.625000</td>
<td>28.050000</td>
<td>4.475000</td>
<td>0.850000</td>
<td>4.925000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>9.450000</td>
<td>11.250000</td>
<td>1.575000</td>
<td>32.325000</td>
<td>6.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Lower Far Northeast</td>
<td>0.500000</td>
<td>20.558333</td>
<td>10.858333</td>
<td>2.366667</td>
<td>3.150000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>7.000000</td>
<td>8.858333</td>
<td>0.000000</td>
<td>36.966667</td>
<td>9.716667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Lower North</td>
<td>1.781818</td>
<td>19.118182</td>
<td>9.100000</td>
<td>4.800000</td>
<td>8.163636</td>
<td>0.000000</td>
<td>2.418182</td>
<td>4.263636</td>
<td>5.790909</td>
<td>3.509091</td>
<td>34.509091</td>
<td>6.572727</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Lower Northeast</td>
<td>0.000000</td>
<td>27.800000</td>
<td>2.800000</td>
<td>0.300000</td>
<td>13.020000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.340000</td>
<td>2.300000</td>
<td>0.000000</td>
<td>31.580000</td>
<td>18.840000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Lower Northwest</td>
<td>0.466667</td>
<td>22.522222</td>
<td>9.966667</td>
<td>3.811111</td>
<td>7.566667</td>
<td>1.388889</td>
<td>0.000000</td>
<td>4.655556</td>
<td>11.611111</td>
<td>1.922222</td>
<td>27.311111</td>
<td>8.777778</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Lower South</td>
<td>0.366667</td>
<td>8.100000</td>
<td>1.766667</td>
<td>14.600000</td>
<td>1.100000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>15.133333</td>
<td>11.966667</td>
<td>6.133333</td>
<td>37.266667</td>
<td>3.533333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Lower Southwest</td>
<td>0.414286</td>
<td>10.914286</td>
<td>2.228571</td>
<td>1.557143</td>
<td>8.800000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.985714</td>
<td>13.357143</td>
<td>0.414286</td>
<td>52.242857</td>
<td>9.028571</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">North</td>
<td>0.209091</td>
<td>23.318182</td>
<td>6.372727</td>
<td>1.763636</td>
<td>3.781818</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.309091</td>
<td>12.609091</td>
<td>0.418182</td>
<td>37.890909</td>
<td>12.372727</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">North Delaware</td>
<td>1.220000</td>
<td>24.700000</td>
<td>4.840000</td>
<td>2.320000</td>
<td>6.420000</td>
<td>0.500000</td>
<td>0.000000</td>
<td>4.560000</td>
<td>10.400000</td>
<td>1.980000</td>
<td>37.180000</td>
<td>5.880000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">River Wards</td>
<td>2.480000</td>
<td>20.820000</td>
<td>5.580000</td>
<td>6.220000</td>
<td>8.260000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>2.940000</td>
<td>14.580000</td>
<td>1.540000</td>
<td>27.220000</td>
<td>10.340000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">South</td>
<td>4.315385</td>
<td>19.176923</td>
<td>4.876923</td>
<td>7.392308</td>
<td>11.361538</td>
<td>0.223077</td>
<td>0.315385</td>
<td>6.500000</td>
<td>14.200000</td>
<td>3.815385</td>
<td>20.215385</td>
<td>7.607692</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">University Southwest</td>
<td>2.072727</td>
<td>12.481818</td>
<td>9.654545</td>
<td>3.872727</td>
<td>5.663636</td>
<td>0.318182</td>
<td>4.545455</td>
<td>11.063636</td>
<td>7.063636</td>
<td>6.618182</td>
<td>27.900000</td>
<td>8.754545</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Upper Far Northeast</td>
<td>1.100000</td>
<td>27.266667</td>
<td>3.833333</td>
<td>19.966667</td>
<td>4.066667</td>
<td>0.000000</td>
<td>0.000000</td>
<td>2.766667</td>
<td>3.033333</td>
<td>8.900000</td>
<td>22.300000</td>
<td>6.733333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Upper North</td>
<td>0.475000</td>
<td>20.425000</td>
<td>10.575000</td>
<td>1.350000</td>
<td>10.650000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>2.100000</td>
<td>2.100000</td>
<td>0.000000</td>
<td>42.362500</td>
<td>9.925000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Upper Northwest</td>
<td>2.200000</td>
<td>22.281818</td>
<td>8.554545</td>
<td>4.463636</td>
<td>6.809091</td>
<td>0.300000</td>
<td>0.581818</td>
<td>7.018182</td>
<td>3.054545</td>
<td>4.818182</td>
<td>30.345455</td>
<td>9.581818</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">West</td>
<td>0.133333</td>
<td>34.511111</td>
<td>11.833333</td>
<td>2.255556</td>
<td>9.477778</td>
<td>0.000000</td>
<td>0.000000</td>
<td>8.433333</td>
<td>4.422222</td>
<td>3.900000</td>
<td>19.388889</td>
<td>5.611111</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">West Park</td>
<td>4.180000</td>
<td>12.520000</td>
<td>3.920000</td>
<td>15.880000</td>
<td>5.440000</td>
<td>0.000000</td>
<td>1.600000</td>
<td>5.780000</td>
<td>11.420000</td>
<td>3.200000</td>
<td>17.240000</td>
<td>18.820000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© CC-Anna Duan, Trevor Kapuvari, &amp; Timothy Oliver, 2023</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>